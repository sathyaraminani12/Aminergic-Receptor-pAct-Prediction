{"cells":[{"cell_type":"markdown","metadata":{"id":"w6PiODmza45r"},"source":["###cuML Setup"]},{"cell_type":"code","execution_count":1,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":21,"status":"ok","timestamp":1700264265179,"user":{"displayName":"Sathya Raminani","userId":"13681115488434516434"},"user_tz":480},"id":"5u8Ul-eqsVGl","outputId":"d87876dc-16bf-47d6-c14c-ad4fe2ed1fdd"},"outputs":[{"output_type":"stream","name":"stdout","text":["Fri Nov 17 23:37:44 2023       \n","+-----------------------------------------------------------------------------+\n","| NVIDIA-SMI 525.105.17   Driver Version: 525.105.17   CUDA Version: 12.0     |\n","|-------------------------------+----------------------+----------------------+\n","| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |\n","| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |\n","|                               |                      |               MIG M. |\n","|===============================+======================+======================|\n","|   0  Tesla T4            Off  | 00000000:00:04.0 Off |                    0 |\n","| N/A   57C    P8    10W /  70W |      0MiB / 15360MiB |      0%      Default |\n","|                               |                      |                  N/A |\n","+-------------------------------+----------------------+----------------------+\n","                                                                               \n","+-----------------------------------------------------------------------------+\n","| Processes:                                                                  |\n","|  GPU   GI   CI        PID   Type   Process name                  GPU Memory |\n","|        ID   ID                                                   Usage      |\n","|=============================================================================|\n","|  No running processes found                                                 |\n","+-----------------------------------------------------------------------------+\n"]}],"source":["!nvidia-smi"]},{"cell_type":"code","execution_count":2,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":9832,"status":"ok","timestamp":1700264318699,"user":{"displayName":"Sathya Raminani","userId":"13681115488434516434"},"user_tz":480},"id":"toRDCGSEbE_2","outputId":"75da5ae0-1fa3-4dbc-9e1f-2b7268ed07d1"},"outputs":[{"output_type":"stream","name":"stdout","text":["Cloning into 'rapidsai-csp-utils'...\n","remote: Enumerating objects: 395, done.\u001b[K\n","remote: Counting objects: 100% (126/126), done.\u001b[K\n","remote: Compressing objects: 100% (75/75), done.\u001b[K\n","remote: Total 395 (delta 92), reused 53 (delta 51), pack-reused 269\u001b[K\n","Receiving objects: 100% (395/395), 108.50 KiB | 10.85 MiB/s, done.\n","Resolving deltas: 100% (194/194), done.\n","Collecting pynvml\n","  Downloading pynvml-11.5.0-py3-none-any.whl (53 kB)\n","     â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 53.1/53.1 kB 1.6 MB/s eta 0:00:00\n","Installing collected packages: pynvml\n","Successfully installed pynvml-11.5.0\n","***********************************************************************\n","Woo! Your instance has the right kind of GPU, a Tesla T4!\n","We will now install RAPIDS via pip!  Please stand by, should be quick...\n","***********************************************************************\n","\n"]}],"source":["# This get the RAPIDS-Colab install files and test check your GPU.  Run this and the next cell only.\n","# Please read the output of this cell.  If your Colab Instance is not RAPIDS compatible, it will warn you and give you remediation steps.\n","!git clone https://github.com/rapidsai/rapidsai-csp-utils.git\n","!python rapidsai-csp-utils/colab/env-check.py"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"I4DYH4SebFch","outputId":"2519cb0e-a59e-4129-f5a2-50d091ce2086"},"outputs":[{"output_type":"stream","name":"stdout","text":["Updating your Colab environment.  This will restart your kernel.  Don't Panic!\n","Found existing installation: cupy-cuda11x 11.0.0\n","Uninstalling cupy-cuda11x-11.0.0:\n","  Successfully uninstalled cupy-cuda11x-11.0.0\n","PPA publishes dbgsym, you may need to include 'main/debug' component\n","Repository: 'deb https://ppa.launchpadcontent.net/ubuntu-toolchain-r/test/ubuntu/ jammy main'\n","Description:\n","Toolchain test builds; see https://wiki.ubuntu.com/ToolChain\n","\n","More info: https://launchpad.net/~ubuntu-toolchain-r/+archive/ubuntu/test\n","Adding repository.\n","Adding deb entry to /etc/apt/sources.list.d/ubuntu-toolchain-r-ubuntu-test-jammy.list\n","Adding disabled deb-src entry to /etc/apt/sources.list.d/ubuntu-toolchain-r-ubuntu-test-jammy.list\n","Adding key to /etc/apt/trusted.gpg.d/ubuntu-toolchain-r-ubuntu-test.gpg with fingerprint 60C317803A41BA51845E371A1E9377A2BA9EF27F\n","Get:1 https://cloud.r-project.org/bin/linux/ubuntu jammy-cran40/ InRelease [3,626 B]\n","Hit:2 https://developer.download.nvidia.com/compute/cuda/repos/ubuntu2204/x86_64  InRelease\n","Get:3 http://security.ubuntu.com/ubuntu jammy-security InRelease [110 kB]\n","Hit:4 http://archive.ubuntu.com/ubuntu jammy InRelease\n","Get:5 http://archive.ubuntu.com/ubuntu jammy-updates InRelease [119 kB]\n","Hit:6 https://ppa.launchpadcontent.net/c2d4u.team/c2d4u4.0+/ubuntu jammy InRelease\n","Hit:7 https://ppa.launchpadcontent.net/deadsnakes/ppa/ubuntu jammy InRelease\n","Hit:8 https://ppa.launchpadcontent.net/graphics-drivers/ppa/ubuntu jammy InRelease\n","Get:9 http://security.ubuntu.com/ubuntu jammy-security/multiverse amd64 Packages [44.0 kB]\n","Get:10 https://ppa.launchpadcontent.net/ubuntu-toolchain-r/test/ubuntu jammy InRelease [23.8 kB]\n","Hit:11 https://ppa.launchpadcontent.net/ubuntugis/ppa/ubuntu jammy InRelease\n","Get:12 https://ppa.launchpadcontent.net/ubuntu-toolchain-r/test/ubuntu jammy/main amd64 Packages [17.4 kB]\n","Hit:13 http://archive.ubuntu.com/ubuntu jammy-backports InRelease\n","Get:14 http://archive.ubuntu.com/ubuntu jammy-updates/multiverse amd64 Packages [49.8 kB]\n","Get:15 http://archive.ubuntu.com/ubuntu jammy-updates/universe amd64 Packages [1,278 kB]\n","Get:16 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 Packages [1,473 kB]\n","Fetched 3,118 kB in 3s (911 kB/s)\n","Reading package lists... Done\n","Added repo\n","Hit:1 https://cloud.r-project.org/bin/linux/ubuntu jammy-cran40/ InRelease\n","Hit:2 https://developer.download.nvidia.com/compute/cuda/repos/ubuntu2204/x86_64  InRelease\n","Hit:3 http://security.ubuntu.com/ubuntu jammy-security InRelease\n","Hit:4 http://archive.ubuntu.com/ubuntu jammy InRelease\n","Hit:5 http://archive.ubuntu.com/ubuntu jammy-updates InRelease\n","Hit:6 https://ppa.launchpadcontent.net/c2d4u.team/c2d4u4.0+/ubuntu jammy InRelease\n","Hit:7 http://archive.ubuntu.com/ubuntu jammy-backports InRelease\n","Hit:8 https://ppa.launchpadcontent.net/deadsnakes/ppa/ubuntu jammy InRelease\n","Hit:9 https://ppa.launchpadcontent.net/graphics-drivers/ppa/ubuntu jammy InRelease\n","Hit:10 https://ppa.launchpadcontent.net/ubuntu-toolchain-r/test/ubuntu jammy InRelease\n","Hit:11 https://ppa.launchpadcontent.net/ubuntugis/ppa/ubuntu jammy InRelease\n","Reading package lists... Done\n","Installing libstdc++\n","Reading package lists... Done\n"]}],"source":["# This will update the Colab environment and restart the kernel.  Don't run the next cell until you see the session crash.\n","!bash rapidsai-csp-utils/colab/update_gcc.sh\n","import os\n","os._exit(00)"]},{"cell_type":"code","execution_count":1,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":16540,"status":"ok","timestamp":1700264389057,"user":{"displayName":"Sathya Raminani","userId":"13681115488434516434"},"user_tz":480},"id":"yOwEHKhLbVHh","outputId":"fb5cd63c-c3c4-4efb-c8c5-13b6bf8de483"},"outputs":[{"output_type":"stream","name":"stdout","text":["â¬ Downloading https://github.com/conda-forge/miniforge/releases/download/23.1.0-1/Mambaforge-23.1.0-1-Linux-x86_64.sh...\n","ðŸ“¦ Installing...\n","ðŸ“Œ Adjusting configuration...\n","ðŸ©¹ Patching environment...\n","â² Done in 0:00:16\n","ðŸ” Restarting kernel...\n"]}],"source":["# This will install CondaColab.  This will restart your kernel one last time.  Run this cell by itself and only run the next cell once you see the session crash.\n","import condacolab\n","condacolab.install()"]},{"cell_type":"code","execution_count":1,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":20,"status":"ok","timestamp":1700264399675,"user":{"displayName":"Sathya Raminani","userId":"13681115488434516434"},"user_tz":480},"id":"dBA_JyV7bdO8","outputId":"f1ae17a9-c5fc-4ad7-8e4b-d0f024b7f010"},"outputs":[{"output_type":"stream","name":"stdout","text":["âœ¨ðŸ°âœ¨ Everything looks OK!\n"]}],"source":["# you can now run the rest of the cells as normal\n","import condacolab\n","condacolab.check()"]},{"cell_type":"code","execution_count":2,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":861828,"status":"ok","timestamp":1700265263434,"user":{"displayName":"Sathya Raminani","userId":"13681115488434516434"},"user_tz":480},"id":"w1738yurbeyI","outputId":"376a1bd7-3f6c-415b-cc13-8fffe5fc5b8c"},"outputs":[{"output_type":"stream","name":"stdout","text":["Found existing installation: cffi 1.15.1\n","Uninstalling cffi-1.15.1:\n","  Successfully uninstalled cffi-1.15.1\n","WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv\n","Found existing installation: cryptography 40.0.1\n","Uninstalling cryptography-40.0.1:\n","  Successfully uninstalled cryptography-40.0.1\n","WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv\n","Collecting cffi==1.15.0\n","  Downloading cffi-1.15.0-cp310-cp310-manylinux_2_12_x86_64.manylinux2010_x86_64.whl (446 kB)\n","     â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 446.3/446.3 kB 18.4 MB/s eta 0:00:00\n","Requirement already satisfied: pycparser in /usr/local/lib/python3.10/site-packages (from cffi==1.15.0) (2.21)\n","Installing collected packages: cffi\n","Successfully installed cffi-1.15.0\n","WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv\n","Installing RAPIDS Stable 23.10\n","Starting the RAPIDS install on Colab.  This will take about 15 minutes.\n","Collecting package metadata (current_repodata.json): ...working... done\n","Solving environment: ...working... done\n","\n","\n","==> WARNING: A newer version of conda exists. <==\n","  current version: 23.1.0\n","  latest version: 23.10.0\n","\n","Please update conda by running\n","\n","    $ conda update -n base -c conda-forge conda\n","\n","Or to minimize the number of packages updated during conda update use\n","\n","     conda install conda=23.10.0\n","\n","\n","\n","## Package Plan ##\n","\n","  environment location: /usr/local\n","\n","  added / updated specs:\n","    - mamba\n","\n","\n","The following packages will be downloaded:\n","\n","    package                    |            build\n","    ---------------------------|-----------------\n","    ca-certificates-2023.7.22  |       hbcca054_0         146 KB  conda-forge\n","    certifi-2023.7.22          |     pyhd8ed1ab_0         150 KB  conda-forge\n","    openssl-3.1.4              |       hd590300_0         2.5 MB  conda-forge\n","    python_abi-3.10            |          4_cp310           6 KB  conda-forge\n","    ------------------------------------------------------------\n","                                           Total:         2.8 MB\n","\n","The following packages will be UPDATED:\n","\n","  ca-certificates                      2022.12.7-ha878542_0 --> 2023.7.22-hbcca054_0\n","  certifi                            2022.12.7-pyhd8ed1ab_0 --> 2023.7.22-pyhd8ed1ab_0\n","  openssl                                  3.1.0-h0b41bf4_0 --> 3.1.4-hd590300_0\n","  python_abi                                   3.10-3_cp310 --> 3.10-4_cp310\n","\n","\n","\n","Downloading and Extracting Packages\n","\n","python_abi-3.10      | 6 KB      |            |   0%\n","\n","certifi-2023.7.22    | 150 KB    |            |   0% \u001b[A\n","\n","\n","openssl-3.1.4        | 2.5 MB    |            |   0% \u001b[A\u001b[A\n","\n","\n","\n","ca-certificates-2023 | 146 KB    |            |   0% \u001b[A\u001b[A\u001b[A\n","python_abi-3.10      | 6 KB      | ########## | 100%\n","\n","certifi-2023.7.22    | 150 KB    | #          |  11% \u001b[A\n","\n","\n","openssl-3.1.4        | 2.5 MB    |            |   1% \u001b[A\u001b[A\n","\n","certifi-2023.7.22    | 150 KB    | ########## | 100% \u001b[A\n","\n","\n","\n","ca-certificates-2023 | 146 KB    | #          |  11% \u001b[A\u001b[A\u001b[A\n","\n","\n","\n","ca-certificates-2023 | 146 KB    | ########## | 100% \u001b[A\u001b[A\u001b[A\n","\n","\n","openssl-3.1.4        | 2.5 MB    | ########## | 100% \u001b[A\u001b[A\n","\n","\n","openssl-3.1.4        | 2.5 MB    | ########## | 100% \u001b[A\u001b[A\n","\n","\n","                                                     \u001b[A\n","\n","\n","                                                     \u001b[A\u001b[A\n","\n","\n","\n","                                                     \u001b[A\u001b[A\u001b[A\n","Preparing transaction: ...working... done\n","Verifying transaction: ...working... done\n","Executing transaction: ...working... done\n","Transaction\n","\n","  Prefix: /usr/local\n","\n","  Updating specs:\n","\n","   - python=3.10\n","   - cudatoolkit=11.8\n","   - rapids=23.10\n","   - llvmlite\n","   - gcsfs\n","   - openssl\n","   - dask-sql\n","   - ca-certificates\n","   - certifi\n","   - openssl\n","\n","\n","  Package                               Version  Build                              Channel                    Size\n","â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n","  Install:\n","â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n","\n","  + aiohttp                               3.8.6  py310h2372a71_1                    conda-forge/linux-64      650kB\n","  + aiosignal                             1.3.1  pyhd8ed1ab_0                       conda-forge/noarch         13kB\n","  + annotated-types                       0.6.0  pyhd8ed1ab_0                       conda-forge/noarch         17kB\n","  + anyio                                 3.7.1  pyhd8ed1ab_0                       conda-forge/noarch         97kB\n","  + appdirs                               1.4.4  pyh9f0ad1d_0                       conda-forge/noarch         13kB\n","  + argon2-cffi                          23.1.0  pyhd8ed1ab_0                       conda-forge/noarch         19kB\n","  + argon2-cffi-bindings                 21.2.0  py310h2372a71_4                    conda-forge/linux-64       34kB\n","  + arrow                                 1.3.0  pyhd8ed1ab_0                       conda-forge/noarch        100kB\n","  + async-timeout                         4.0.3  pyhd8ed1ab_0                       conda-forge/noarch         11kB\n","  + attrs                                23.1.0  pyh71513ae_1                       conda-forge/noarch         55kB\n","  + aws-c-auth                            0.7.0  hf8751d9_2                         conda-forge/linux-64      102kB\n","  + aws-c-cal                             0.6.0  h93469e0_0                         conda-forge/linux-64       50kB\n","  + aws-c-common                         0.8.23  hd590300_0                         conda-forge/linux-64      197kB\n","  + aws-c-compression                    0.2.17  h862ab75_1                         conda-forge/linux-64       19kB\n","  + aws-c-event-stream                    0.3.1  h9599702_1                         conda-forge/linux-64       54kB\n","  + aws-c-http                           0.7.11  hbe98c3e_0                         conda-forge/linux-64      194kB\n","  + aws-c-io                            0.13.28  h3870b5a_0                         conda-forge/linux-64      155kB\n","  + aws-c-mqtt                           0.8.14  h2e270ba_2                         conda-forge/linux-64      154kB\n","  + aws-c-s3                             0.3.13  heb0bb06_2                         conda-forge/linux-64       87kB\n","  + aws-c-sdkutils                       0.1.11  h862ab75_1                         conda-forge/linux-64       53kB\n","  + aws-checksums                        0.1.16  h862ab75_1                         conda-forge/linux-64       50kB\n","  + aws-crt-cpp                          0.20.3  he9c0e7f_4                         conda-forge/linux-64      321kB\n","  + aws-sdk-cpp                         1.10.57  hbc2ea52_17                        conda-forge/linux-64        4MB\n","  + backports                               1.0  pyhd8ed1ab_3                       conda-forge/noarch          6kB\n","  + backports.functools_lru_cache         1.6.5  pyhd8ed1ab_0                       conda-forge/noarch         12kB\n","  + beautifulsoup4                       4.12.2  pyha770c72_0                       conda-forge/noarch        115kB\n","  + bleach                                6.1.0  pyhd8ed1ab_0                       conda-forge/noarch        131kB\n","  + blinker                               1.7.0  pyhd8ed1ab_0                       conda-forge/noarch         18kB\n","  + blosc                                1.21.5  h0f2a231_0                         conda-forge/linux-64       49kB\n","  + bokeh                                 3.3.1  pyhd8ed1ab_0                       conda-forge/noarch          5MB\n","  + branca                                0.7.0  pyhd8ed1ab_1                       conda-forge/noarch         29kB\n","  + brotli                                1.0.9  h166bdaf_9                         conda-forge/linux-64       20kB\n","  + brotli-bin                            1.0.9  h166bdaf_9                         conda-forge/linux-64       20kB\n","  + cached-property                       1.5.2  hd8ed1ab_1                         conda-forge/noarch          4kB\n","  + cached_property                       1.5.2  pyha770c72_1                       conda-forge/noarch         11kB\n","  + cachetools                            5.3.2  pyhd8ed1ab_0                       conda-forge/noarch         15kB\n","  + cairo                                1.16.0  hbbf8b49_1016                      conda-forge/linux-64        1MB\n","  + cfitsio                               4.2.0  hd9d235c_0                         conda-forge/linux-64      848kB\n","  + click                                 8.1.7  unix_pyh707e725_0                  conda-forge/noarch         84kB\n","  + click-plugins                         1.1.1  py_0                               conda-forge/noarch          9kB\n","  + cligj                                 0.7.2  pyhd8ed1ab_1                       conda-forge/noarch         10kB\n","  + cloudpickle                           3.0.0  pyhd8ed1ab_0                       conda-forge/noarch         25kB\n","  + colorcet                              3.0.1  pyhd8ed1ab_0                       conda-forge/noarch          2MB\n","  + contourpy                             1.2.0  py310hd41b1e2_0                    conda-forge/linux-64      239kB\n","  + cubinlinker                           0.3.0  py310hfdf336d_0                    rapidsai/linux-64           8MB\n","  + cucim                              23.10.00  cuda11_py310_231011_g8dd1727_0     rapidsai/linux-64           4MB\n","  + cuda-cudart                         11.8.89  0                                  nvidia/linux-64           202kB\n","  + cuda-nvrtc                          11.8.89  0                                  nvidia/linux-64            20MB\n","  + cuda-profiler-api                   11.8.86  0                                  nvidia/linux-64            19kB\n","  + cuda-python                          11.8.3  py310hf9913ef_0                    nvidia/linux-64             6MB\n","  + cuda-version                           11.8  h70ddcb2_2                         conda-forge/noarch         21kB\n","  + cudatoolkit                          11.8.0  h4ba93d1_12                        conda-forge/linux-64      716MB\n","  + cudf                               23.10.02  cuda11_py310_231116_gece2b2c524_0  rapidsai/linux-64           8MB\n","  + cudf_kafka                         23.10.02  cuda11_py310_231116_gece2b2c524_0  rapidsai/linux-64         139kB\n","  + cugraph                            23.10.00  cuda11_py310_231011_gc3dc860d_0    rapidsai/linux-64           2MB\n","  + cuml                               23.10.00  cuda11_py310_231011_g623996072_0   rapidsai/linux-64          10MB\n","  + cuproj                             23.10.00  cuda11_py310_231011_g29cddcdc_0    rapidsai/linux-64         875kB\n","  + cupy                                 12.2.0  py310hf4db66c_4                    conda-forge/linux-64       42MB\n","  + cuspatial                          23.10.00  cuda11_py310_231011_g29cddcdc_0    rapidsai/linux-64         996kB\n","  + custreamz                          23.10.02  cuda11_py310_231116_gece2b2c524_0  rapidsai/linux-64          34kB\n","  + cuxfilter                          23.10.00  cuda11_py310_231011_g6600aff_0     rapidsai/linux-64         112kB\n","  + cycler                               0.12.1  pyhd8ed1ab_0                       conda-forge/noarch         13kB\n","  + cyrus-sasl                           2.1.27  h54b06d7_7                         conda-forge/linux-64      220kB\n","  + cytoolz                              0.12.2  py310h2372a71_1                    conda-forge/linux-64      368kB\n","  + dask                               2023.9.2  pyhd8ed1ab_0                       conda-forge/noarch          7kB\n","  + dask-core                          2023.9.2  pyhd8ed1ab_0                       conda-forge/noarch        859kB\n","  + dask-cuda                          23.10.00  py310_231011_gdc811d3_0            rapidsai/linux-64         188kB\n","  + dask-cudf                          23.10.02  cuda11_py310_231116_gece2b2c524_0  rapidsai/linux-64         138kB\n","  + dask-sql                          2023.10.1  py310hdc01190_0                    conda-forge/linux-64       12MB\n","  + datashader                           0.16.0  pyhd8ed1ab_0                       conda-forge/noarch         17MB\n","  + decorator                             5.1.1  pyhd8ed1ab_0                       conda-forge/noarch         12kB\n","  + defusedxml                            0.7.1  pyhd8ed1ab_0                       conda-forge/noarch         24kB\n","  + distributed                        2023.9.2  pyhd8ed1ab_0                       conda-forge/noarch        785kB\n","  + dlpack                                  0.5  h9c3ff4c_0                         conda-forge/linux-64       13kB\n","  + entrypoints                             0.4  pyhd8ed1ab_0                       conda-forge/noarch          9kB\n","  + exceptiongroup                        1.1.3  pyhd8ed1ab_0                       conda-forge/noarch         19kB\n","  + expat                                 2.5.0  hcb278e6_1                         conda-forge/linux-64      137kB\n","  + fastapi                             0.104.1  pyhd8ed1ab_0                       conda-forge/noarch         71kB\n","  + fastrlock                             0.8.2  py310hc6cd4ac_1                    conda-forge/linux-64       37kB\n","  + fiona                                 1.9.3  py310ha325b7b_0                    conda-forge/linux-64      902kB\n","  + folium                               0.15.0  pyhd8ed1ab_0                       conda-forge/noarch         73kB\n","  + font-ttf-dejavu-sans-mono              2.37  hab24e00_0                         conda-forge/noarch        397kB\n","  + font-ttf-inconsolata                  3.000  h77eed37_0                         conda-forge/noarch         97kB\n","  + font-ttf-source-code-pro              2.038  h77eed37_0                         conda-forge/noarch        701kB\n","  + font-ttf-ubuntu                        0.83  hab24e00_0                         conda-forge/noarch          2MB\n","  + fontconfig                           2.14.2  h14ed4e7_0                         conda-forge/linux-64      272kB\n","  + fonts-conda-ecosystem                     1  0                                  conda-forge/noarch          4kB\n","  + fonts-conda-forge                         1  0                                  conda-forge/noarch          4kB\n","  + fonttools                            4.44.3  py310h2372a71_0                    conda-forge/linux-64        2MB\n","  + fqdn                                  1.5.1  pyhd8ed1ab_0                       conda-forge/noarch         14kB\n","  + freetype                             2.12.1  h267a509_2                         conda-forge/linux-64      635kB\n","  + freexl                                2.0.0  h743c826_0                         conda-forge/linux-64       60kB\n","  + frozenlist                            1.4.0  py310h2372a71_1                    conda-forge/linux-64       54kB\n","  + fsspec                            2023.10.0  pyhca7485f_0                       conda-forge/noarch        125kB\n","  + gcsfs                             2023.10.0  pyhd8ed1ab_0                       conda-forge/noarch         36kB\n","  + gdal                                  3.6.4  py310h5c4b078_20                   conda-forge/linux-64        1MB\n","  + gdk-pixbuf                          2.42.10  h6c15284_3                         conda-forge/linux-64      574kB\n","  + geopandas                            0.14.1  pyhd8ed1ab_0                       conda-forge/noarch          8kB\n","  + geopandas-base                       0.14.1  pyha770c72_0                       conda-forge/noarch          1MB\n","  + geos                                 3.12.0  h59595ed_0                         conda-forge/linux-64        2MB\n","  + geotiff                               1.7.1  hee599c5_13                        conda-forge/linux-64      133kB\n","  + gettext                              0.21.1  h27087fc_0                         conda-forge/linux-64        4MB\n","  + gflags                                2.2.2  he1b5a44_1004                      conda-forge/linux-64      117kB\n","  + giflib                                5.2.1  h0b41bf4_3                         conda-forge/linux-64       77kB\n","  + glog                                  0.6.0  h6f12383_0                         conda-forge/linux-64      114kB\n","  + gmock                                1.14.0  ha770c72_1                         conda-forge/linux-64        7kB\n","  + google-api-core                      2.14.0  pyhd8ed1ab_0                       conda-forge/noarch         79kB\n","  + google-auth                          2.23.4  pyhca7485f_0                       conda-forge/noarch        102kB\n","  + google-auth-oauthlib                  1.1.0  pyhd8ed1ab_0                       conda-forge/noarch         21kB\n","  + google-cloud-core                     2.3.3  pyhd8ed1ab_0                       conda-forge/noarch         29kB\n","  + google-cloud-storage                 2.13.0  pyhca7485f_0                       conda-forge/noarch         87kB\n","  + google-crc32c                         1.1.2  py310hc5c09a0_5                    conda-forge/linux-64       24kB\n","  + google-resumable-media                2.6.0  pyhd8ed1ab_0                       conda-forge/noarch         46kB\n","  + googleapis-common-protos             1.61.0  pyhd8ed1ab_0                       conda-forge/noarch        123kB\n","  + grpcio                               1.54.2  py310heca2aa9_2                    conda-forge/linux-64      755kB\n","  + gtest                                1.14.0  h00ab1b0_1                         conda-forge/linux-64      405kB\n","  + h11                                  0.14.0  pyhd8ed1ab_0                       conda-forge/noarch         48kB\n","  + h2                                    4.1.0  pyhd8ed1ab_0                       conda-forge/noarch         47kB\n","  + hdf4                                 4.2.15  h501b40f_6                         conda-forge/linux-64      758kB\n","  + hdf5                                 1.14.2  nompi_h4f84152_100                 conda-forge/linux-64        4MB\n","  + holoviews                            1.18.1  pyhd8ed1ab_0                       conda-forge/noarch          3MB\n","  + hpack                                 4.0.0  pyh9f0ad1d_0                       conda-forge/noarch         25kB\n","  + httpcore                              1.0.2  pyhd8ed1ab_0                       conda-forge/noarch         45kB\n","  + httpx                                0.25.1  pyhd8ed1ab_0                       conda-forge/noarch         64kB\n","  + hyperframe                            6.0.1  pyhd8ed1ab_0                       conda-forge/noarch         15kB\n","  + imagecodecs-lite                  2019.12.3  py310h1f7b6fc_7                    conda-forge/linux-64      169kB\n","  + imageio                              2.31.5  pyh8c1a49c_0                       conda-forge/noarch        291kB\n","  + importlib-metadata                    6.8.0  pyha770c72_0                       conda-forge/noarch         26kB\n","  + importlib_metadata                    6.8.0  hd8ed1ab_0                         conda-forge/noarch          9kB\n","  + importlib_resources                   6.1.1  pyhd8ed1ab_0                       conda-forge/noarch         30kB\n","  + isoduration                         20.11.0  pyhd8ed1ab_0                       conda-forge/noarch         17kB\n","  + jbig                                    2.1  h7f98852_2003                      conda-forge/linux-64       44kB\n","  + jinja2                                3.1.2  pyhd8ed1ab_1                       conda-forge/noarch        101kB\n","  + joblib                                1.3.2  pyhd8ed1ab_0                       conda-forge/noarch        221kB\n","  + json-c                                 0.17  h7ab15ed_0                         conda-forge/linux-64       83kB\n","  + jsonpointer                             2.4  py310hff52083_3                    conda-forge/linux-64       16kB\n","  + jsonschema                           4.20.0  pyhd8ed1ab_0                       conda-forge/noarch         72kB\n","  + jsonschema-specifications         2023.11.1  pyhd8ed1ab_0                       conda-forge/noarch         15kB\n","  + jsonschema-with-format-nongpl        4.20.0  pyhd8ed1ab_0                       conda-forge/noarch          7kB\n","  + jupyter-server-proxy                  4.1.0  pyhd8ed1ab_0                       conda-forge/noarch         34kB\n","  + jupyter_client                        8.6.0  pyhd8ed1ab_0                       conda-forge/noarch        106kB\n","  + jupyter_core                          5.5.0  py310hff52083_0                    conda-forge/linux-64       79kB\n","  + jupyter_events                        0.9.0  pyhd8ed1ab_0                       conda-forge/noarch         21kB\n","  + jupyter_server                       2.10.1  pyhd8ed1ab_0                       conda-forge/noarch        319kB\n","  + jupyter_server_terminals              0.4.4  pyhd8ed1ab_1                       conda-forge/noarch         19kB\n","  + jupyterlab_pygments                   0.2.2  pyhd8ed1ab_0                       conda-forge/noarch         17kB\n","  + kealib                                1.5.2  hcd42e92_1                         conda-forge/linux-64      170kB\n","  + kiwisolver                            1.4.5  py310hd41b1e2_1                    conda-forge/linux-64       73kB\n","  + lazy_loader                             0.3  pyhd8ed1ab_0                       conda-forge/noarch         14kB\n","  + lcms2                                  2.15  h7f713cb_2                         conda-forge/linux-64      241kB\n","  + lerc                                  4.0.0  h27087fc_0                         conda-forge/linux-64      282kB\n","  + libabseil                        20230125.3  cxx17_h59595ed_0                   conda-forge/linux-64        1MB\n","  + libaec                                1.1.2  h59595ed_1                         conda-forge/linux-64       35kB\n","  + libarrow                             12.0.1  hd2d78f0_7_cpu                     conda-forge/linux-64       28MB\n","  + libblas                               3.9.0  19_linux64_openblas                conda-forge/linux-64       15kB\n","  + libboost-headers                     1.82.0  ha770c72_6                         conda-forge/linux-64       14MB\n","  + libbrotlicommon                       1.0.9  h166bdaf_9                         conda-forge/linux-64       71kB\n","  + libbrotlidec                          1.0.9  h166bdaf_9                         conda-forge/linux-64       33kB\n","  + libbrotlienc                          1.0.9  h166bdaf_9                         conda-forge/linux-64      265kB\n","  + libcblas                              3.9.0  19_linux64_openblas                conda-forge/linux-64       14kB\n","  + libcrc32c                             1.1.2  h9c3ff4c_0                         conda-forge/linux-64       20kB\n","  + libcublas                         11.11.3.6  0                                  nvidia/linux-64           382MB\n","  + libcublas-dev                     11.11.3.6  0                                  nvidia/linux-64           413MB\n","  + libcucim                           23.10.00  cuda11_231011_g8dd1727_0           rapidsai/linux-64           5MB\n","  + libcudf                            23.10.02  cuda11_231116_gece2b2c524_0        rapidsai/linux-64         292MB\n","  + libcudf_kafka                      23.10.02  cuda11_231116_gece2b2c524_0        rapidsai/linux-64          39kB\n","  + libcufft                          10.9.0.58  0                                  nvidia/linux-64           150MB\n","  + libcufile                          1.4.0.31  0                                  nvidia/linux-64           561kB\n","  + libcufile-dev                      1.4.0.31  0                                  nvidia/linux-64             2MB\n","  + libcugraph                         23.10.00  cuda11_231011_gc3dc860d_0          rapidsai/linux-64         594MB\n","  + libcugraph_etl                     23.10.00  cuda11_231011_gc3dc860d_0          rapidsai/linux-64         620kB\n","  + libcugraphops                      23.10.00  cuda11_231011_gca4b54ac_0          nvidia/linux-64            38MB\n","  + libcuml                            23.10.00  cuda11_231011_g623996072_0         rapidsai/linux-64         265MB\n","  + libcumlprims                       23.10.00  cuda11_231011_ge818397_0           nvidia/linux-64             5MB\n","  + libcurand                         10.3.0.86  0                                  nvidia/linux-64            56MB\n","  + libcurand-dev                     10.3.0.86  0                                  nvidia/linux-64            56MB\n","  + libcusolver                       11.4.1.48  0                                  nvidia/linux-64           101MB\n","  + libcusolver-dev                   11.4.1.48  0                                  nvidia/linux-64            70MB\n","  + libcusparse                       11.7.5.86  0                                  nvidia/linux-64           185MB\n","  + libcusparse-dev                   11.7.5.86  0                                  nvidia/linux-64           377MB\n","  + libcuspatial                       23.10.00  cuda11_231011_g29cddcdc_0          rapidsai/linux-64          29MB\n","  + libdeflate                             1.19  hd590300_0                         conda-forge/linux-64       67kB\n","  + libevent                             2.1.12  hf998b51_1                         conda-forge/linux-64      427kB\n","  + libexpat                              2.5.0  hcb278e6_1                         conda-forge/linux-64       78kB\n","  + libgdal                               3.6.4  h4a9e2c2_20                        conda-forge/linux-64       10MB\n","  + libgfortran-ng                       13.2.0  h69a702a_0                         conda-forge/linux-64       23kB\n","  + libgfortran5                         13.2.0  ha4646dd_0                         conda-forge/linux-64        1MB\n","  + libglib                              2.78.1  hebfc3b9_0                         conda-forge/linux-64        3MB\n","  + libgoogle-cloud                      2.12.0  hac9eb74_1                         conda-forge/linux-64       46MB\n","  + libgrpc                              1.54.2  hb20ce57_2                         conda-forge/linux-64        6MB\n","  + libjpeg-turbo                       2.1.5.1  hd590300_1                         conda-forge/linux-64      496kB\n","  + libkml                                1.3.0  h01aab08_1018                      conda-forge/linux-64      514kB\n","  + libkvikio                          23.10.00  cuda11_231011_g5ea0525_0           rapidsai/linux-64          38kB\n","  + liblapack                             3.9.0  19_linux64_openblas                conda-forge/linux-64       14kB\n","  + libllvm14                            14.0.6  hcd5def8_4                         conda-forge/linux-64       31MB\n","  + libnetcdf                             4.9.2  nompi_h80fb2b6_112                 conda-forge/linux-64      848kB\n","  + libntlm                                 1.4  h7f98852_1002                      conda-forge/linux-64       33kB\n","  + libnuma                              2.0.16  h0b41bf4_1                         conda-forge/linux-64       41kB\n","  + libopenblas                          0.3.24  pthreads_h413a1c8_0                conda-forge/linux-64        5MB\n","  + libpng                               1.6.39  h753d276_0                         conda-forge/linux-64      283kB\n","  + libpq                                  16.1  hfc447b1_0                         conda-forge/linux-64        3MB\n","  + libprotobuf                         3.21.12  hfc55251_2                         conda-forge/linux-64        2MB\n","  + libraft                            23.10.00  cuda11_231011_gafdddfb3_0          rapidsai/linux-64         639MB\n","  + libraft-headers                    23.10.00  cuda11_231011_gafdddfb3_0          rapidsai/linux-64           6kB\n","  + libraft-headers-only               23.10.00  cuda11_231011_gafdddfb3_0          rapidsai/linux-64           3MB\n","  + librdkafka                            1.9.2  ha5a0de0_2                         conda-forge/linux-64       14MB\n","  + librmm                             23.10.00  cuda11_231011_gf8ac6f8e_0          rapidsai/linux-64         776kB\n","  + librttopo                             1.1.0  hb58d41b_14                        conda-forge/linux-64      233kB\n","  + libsodium                            1.0.18  h36c2ea0_1                         conda-forge/linux-64      375kB\n","  + libspatialindex                       1.9.3  h9c3ff4c_4                         conda-forge/linux-64        5MB\n","  + libspatialite                         5.0.1  h090f1da_29                        conda-forge/linux-64        3MB\n","  + libthrift                            0.18.1  h8fd135c_2                         conda-forge/linux-64        4MB\n","  + libtiff                               4.6.0  h29866fb_1                         conda-forge/linux-64      277kB\n","  + libutf8proc                           2.8.0  h166bdaf_0                         conda-forge/linux-64      101kB\n","  + libuv                                1.44.2  hd590300_1                         conda-forge/linux-64      824kB\n","  + libwebp                               1.3.2  hdffd6e0_0                         conda-forge/linux-64       86kB\n","  + libwebp-base                          1.3.2  hd590300_0                         conda-forge/linux-64      402kB\n","  + libxcb                                 1.15  h0b41bf4_0                         conda-forge/linux-64      384kB\n","  + libxgboost                            1.7.6  rapidsai_h795055c_2310             rapidsai/linux-64         115MB\n","  + libzip                               1.10.1  h2629f0a_3                         conda-forge/linux-64      107kB\n","  + linkify-it-py                         2.0.0  pyhd8ed1ab_0                       conda-forge/noarch         22kB\n","  + llvmlite                             0.40.1  py310h1b8f574_0                    conda-forge/linux-64        3MB\n","  + locket                                1.0.0  pyhd8ed1ab_0                       conda-forge/noarch          8kB\n","  + lz4                                   4.3.2  py310h350c4a5_1                    conda-forge/linux-64       37kB\n","  + mapclassify                           2.6.1  pyhd8ed1ab_0                       conda-forge/noarch         39kB\n","  + markdown                              3.5.1  pyhd8ed1ab_0                       conda-forge/noarch         77kB\n","  + markdown-it-py                        3.0.0  pyhd8ed1ab_0                       conda-forge/noarch         64kB\n","  + markupsafe                            2.1.3  py310h2372a71_1                    conda-forge/linux-64       24kB\n","  + matplotlib-base                       3.8.0  py310h62c0568_1                    conda-forge/linux-64        7MB\n","  + mdit-py-plugins                       0.4.0  pyhd8ed1ab_0                       conda-forge/noarch         41kB\n","  + mdurl                                 0.1.0  pyhd8ed1ab_0                       conda-forge/noarch         14kB\n","  + minizip                               4.0.3  h0ab5242_0                         conda-forge/linux-64       92kB\n","  + mistune                               3.0.2  pyhd8ed1ab_0                       conda-forge/noarch         66kB\n","  + msgpack-python                        1.0.6  py310hd41b1e2_0                    conda-forge/linux-64      197kB\n","  + multidict                             6.0.4  py310h2372a71_1                    conda-forge/linux-64       57kB\n","  + multipledispatch                      0.6.0  py_0                               conda-forge/noarch         12kB\n","  + munch                                 4.0.0  pyhd8ed1ab_0                       conda-forge/noarch         15kB\n","  + munkres                               1.1.4  pyh9f0ad1d_0                       conda-forge/noarch         12kB\n","  + nbclient                              0.8.0  pyhd8ed1ab_0                       conda-forge/noarch         65kB\n","  + nbconvert-core                       7.11.0  pyhd8ed1ab_0                       conda-forge/noarch        188kB\n","  + nbformat                              5.9.2  pyhd8ed1ab_0                       conda-forge/noarch        100kB\n","  + nccl                               2.19.3.1  h6103f9b_1                         conda-forge/linux-64      118MB\n","  + networkx                              3.2.1  pyhd8ed1ab_0                       conda-forge/noarch          1MB\n","  + nodejs                               20.5.1  hf52ce11_0                         conda-forge/linux-64       17MB\n","  + nspr                                   4.35  h27087fc_0                         conda-forge/linux-64      227kB\n","  + nss                                    3.94  h1d7d5a4_0                         conda-forge/linux-64        2MB\n","  + numba                                0.57.1  py310h0f6aa51_0                    conda-forge/linux-64        4MB\n","  + numpy                                1.24.4  py310ha4c1d20_0                    conda-forge/linux-64        7MB\n","  + nvcomp                                2.6.1  h838ba91_3                         conda-forge/linux-64        8MB\n","  + nvtx                                  0.2.8  py310h2372a71_1                    conda-forge/linux-64      105kB\n","  + oauthlib                              3.2.2  pyhd8ed1ab_0                       conda-forge/noarch         92kB\n","  + openjpeg                              2.5.0  h488ebb8_3                         conda-forge/linux-64      357kB\n","  + openslide                             3.4.1  h4738aba_10                        conda-forge/linux-64      112kB\n","  + orc                                   1.9.0  h2f23424_1                         conda-forge/linux-64        1MB\n","  + overrides                             7.4.0  pyhd8ed1ab_0                       conda-forge/noarch         30kB\n","  + packaging                              23.2  pyhd8ed1ab_0                       conda-forge/noarch         49kB\n","  + pandas                                1.5.3  py310h9b08913_1                    conda-forge/linux-64       12MB\n","  + pandocfilters                         1.5.0  pyhd8ed1ab_0                       conda-forge/noarch         12kB\n","  + panel                                 1.3.1  pyhd8ed1ab_0                       conda-forge/noarch         14MB\n","  + param                                 2.0.1  pyhca7485f_0                       conda-forge/noarch        100kB\n","  + partd                                 1.4.1  pyhd8ed1ab_0                       conda-forge/noarch         21kB\n","  + pcre2                                 10.40  hc3806b6_0                         conda-forge/linux-64        2MB\n","  + pillow                               10.0.1  py310h29da1c1_1                    conda-forge/linux-64       46MB\n","  + pixman                               0.42.2  h59595ed_0                         conda-forge/linux-64      385kB\n","  + pkgutil-resolve-name                 1.3.10  pyhd8ed1ab_1                       conda-forge/noarch         11kB\n","  + platformdirs                          4.0.0  pyhd8ed1ab_0                       conda-forge/noarch         20kB\n","  + poppler                             23.08.0  hf2349cb_2                         conda-forge/linux-64        2MB\n","  + poppler-data                         0.4.12  hd8ed1ab_0                         conda-forge/noarch          2MB\n","  + postgresql                             16.1  h8972f4a_0                         conda-forge/linux-64        5MB\n","  + proj                                  9.3.0  h1d62c97_2                         conda-forge/linux-64        3MB\n","  + prometheus_client                    0.18.0  pyhd8ed1ab_1                       conda-forge/noarch         54kB\n","  + prompt-toolkit                       3.0.41  pyha770c72_0                       conda-forge/noarch        270kB\n","  + prompt_toolkit                       3.0.41  hd8ed1ab_0                         conda-forge/noarch          7kB\n","  + protobuf                            4.21.12  py310heca2aa9_0                    conda-forge/linux-64      324kB\n","  + psutil                                5.9.5  py310h2372a71_1                    conda-forge/linux-64      361kB\n","  + pthread-stubs                           0.4  h36c2ea0_1001                      conda-forge/linux-64        6kB\n","  + ptxcompiler                           0.8.1  py310h70a93da_2                    conda-forge/linux-64        8MB\n","  + ptyprocess                            0.7.0  pyhd3deb0d_0                       conda-forge/noarch         17kB\n","  + py-xgboost                            1.7.6  rapidsai_py310h1395376_2310        rapidsai/linux-64         216kB\n","  + pyarrow                              12.0.1  py310h0576679_7_cpu                conda-forge/linux-64        4MB\n","  + pyasn1                                0.5.0  pyhd8ed1ab_0                       conda-forge/noarch         63kB\n","  + pyasn1-modules                        0.3.0  pyhd8ed1ab_0                       conda-forge/noarch         96kB\n","  + pyct                                  0.4.6  py_0                               conda-forge/noarch          3kB\n","  + pyct-core                             0.4.6  py_0                               conda-forge/noarch         14kB\n","  + pydantic                              2.5.1  pyhd8ed1ab_0                       conda-forge/noarch        262kB\n","  + pydantic-core                        2.14.3  py310hcb5633a_0                    conda-forge/linux-64        2MB\n","  + pyee                                  8.1.0  pyhd8ed1ab_0                       conda-forge/noarch         14kB\n","  + pygments                             2.16.1  pyhd8ed1ab_0                       conda-forge/noarch        853kB\n","  + pyjwt                                 2.8.0  pyhd8ed1ab_0                       conda-forge/noarch         25kB\n","  + pylibcugraph                       23.10.00  cuda11_py310_231011_gc3dc860d_0    rapidsai/linux-64         755kB\n","  + pylibraft                          23.10.00  cuda11_py310_231011_gafdddfb3_0    rapidsai/linux-64           2MB\n","  + pynvml                               11.4.1  pyhd8ed1ab_0                       conda-forge/noarch         41kB\n","  + pyparsing                             3.1.1  pyhd8ed1ab_0                       conda-forge/noarch         90kB\n","  + pyppeteer                             1.0.2  pyhd8ed1ab_0                       conda-forge/noarch         64kB\n","  + pyproj                                3.6.1  py310h32c33b7_4                    conda-forge/linux-64      527kB\n","  + python-confluent-kafka                1.9.2  py310h5764c6d_2                    conda-forge/linux-64      149kB\n","  + python-dateutil                       2.8.2  pyhd8ed1ab_0                       conda-forge/noarch        246kB\n","  + python-fastjsonschema                2.19.0  pyhd8ed1ab_0                       conda-forge/noarch        226kB\n","  + python-json-logger                    2.0.7  pyhd8ed1ab_0                       conda-forge/noarch         13kB\n","  + pytz                           2023.3.post1  pyhd8ed1ab_0                       conda-forge/noarch        187kB\n","  + pyu2f                                 0.1.5  pyhd8ed1ab_0                       conda-forge/noarch         32kB\n","  + pyviz_comms                           3.0.0  pyhd8ed1ab_0                       conda-forge/noarch         48kB\n","  + pywavelets                            1.4.1  py310h1f7b6fc_1                    conda-forge/linux-64        4MB\n","  + pyyaml                                6.0.1  py310h2372a71_1                    conda-forge/linux-64      171kB\n","  + pyzmq                                25.1.1  py310h795f18f_2                    conda-forge/linux-64      457kB\n","  + raft-dask                          23.10.00  cuda11_py310_231011_gafdddfb3_0    rapidsai/linux-64         420kB\n","  + rapids                             23.10.00  cuda11_py310_231011_gd3958fe_0     rapidsai/linux-64           6kB\n","  + rapids-xgboost                     23.10.00  cuda11_py310_231011_gd3958fe_0     rapidsai/linux-64           5kB\n","  + rdma-core                              28.9  h59595ed_1                         conda-forge/linux-64        4MB\n","  + re2                              2023.03.02  h8c504da_0                         conda-forge/linux-64      201kB\n","  + referencing                          0.31.0  pyhd8ed1ab_0                       conda-forge/noarch         38kB\n","  + requests-oauthlib                     1.3.1  pyhd8ed1ab_0                       conda-forge/noarch         22kB\n","  + rfc3339-validator                     0.1.4  pyhd8ed1ab_0                       conda-forge/noarch          8kB\n","  + rfc3986-validator                     0.1.1  pyh9f0ad1d_0                       conda-forge/noarch          8kB\n","  + rich                                 13.7.0  pyhd8ed1ab_0                       conda-forge/noarch        184kB\n","  + rmm                                23.10.00  cuda11_py310_231011_gf8ac6f8e_0    rapidsai/linux-64         671kB\n","  + rpds-py                              0.13.0  py310hcb5633a_0                    conda-forge/linux-64      989kB\n","  + rsa                                     4.9  pyhd8ed1ab_0                       conda-forge/noarch         30kB\n","  + rtree                                 1.1.0  py310hbdcdc62_0                    conda-forge/linux-64       50kB\n","  + s2n                                  1.3.46  h06160fa_0                         conda-forge/linux-64      367kB\n","  + scikit-image                         0.20.0  py310h9b08913_1                    conda-forge/linux-64       10MB\n","  + scikit-learn                          1.3.2  py310h1fdf081_1                    conda-forge/linux-64        8MB\n","  + scipy                                1.11.3  py310hb13e2d6_1                    conda-forge/linux-64       15MB\n","  + send2trash                            1.8.2  pyh41d4057_0                       conda-forge/noarch         23kB\n","  + shapely                               2.0.2  py310h7dcad9a_0                    conda-forge/linux-64      482kB\n","  + simpervisor                           1.0.0  pyhd8ed1ab_0                       conda-forge/noarch         13kB\n","  + six                                  1.16.0  pyh6c4a22f_0                       conda-forge/noarch         14kB\n","  + snappy                               1.1.10  h9fff704_0                         conda-forge/linux-64       39kB\n","  + sniffio                               1.3.0  pyhd8ed1ab_0                       conda-forge/noarch         14kB\n","  + sortedcontainers                      2.4.0  pyhd8ed1ab_0                       conda-forge/noarch         26kB\n","  + soupsieve                               2.5  pyhd8ed1ab_1                       conda-forge/noarch         37kB\n","  + spdlog                               1.11.0  h9b3ece8_1                         conda-forge/linux-64      221kB\n","  + sqlite                               3.39.2  h4ff8645_0                         conda-forge/linux-64        2MB\n","  + starlette                            0.27.0  pyhd8ed1ab_0                       conda-forge/noarch         55kB\n","  + streamz                               0.6.4  pyh6c4a22f_0                       conda-forge/noarch         65kB\n","  + tabulate                              0.9.0  pyhd8ed1ab_1                       conda-forge/noarch         36kB\n","  + tblib                                 2.0.0  pyhd8ed1ab_0                       conda-forge/noarch         17kB\n","  + terminado                            0.18.0  pyh0d859eb_0                       conda-forge/noarch         22kB\n","  + threadpoolctl                         3.2.0  pyha21a80b_0                       conda-forge/noarch         21kB\n","  + tifffile                           2020.6.3  py_0                               conda-forge/noarch        111kB\n","  + tiledb                               2.16.3  hf0b6e87_3                         conda-forge/linux-64        6MB\n","  + tinycss2                              1.2.1  pyhd8ed1ab_0                       conda-forge/noarch         23kB\n","  + tornado                               6.3.3  py310h2372a71_1                    conda-forge/linux-64      642kB\n","  + traitlets                            5.13.0  pyhd8ed1ab_0                       conda-forge/noarch        110kB\n","  + treelite                              3.9.1  py310h4a6579d_0                    conda-forge/linux-64      765kB\n","  + types-python-dateutil             2.8.19.14  pyhd8ed1ab_0                       conda-forge/noarch         21kB\n","  + typing-extensions                     4.8.0  hd8ed1ab_0                         conda-forge/noarch         10kB\n","  + typing_extensions                     4.8.0  pyha770c72_0                       conda-forge/noarch         35kB\n","  + typing_utils                          0.1.0  pyhd8ed1ab_0                       conda-forge/noarch         14kB\n","  + tzcode                                2023c  h0b41bf4_0                         conda-forge/linux-64       69kB\n","  + tzlocal                                 5.2  py310hff52083_0                    conda-forge/linux-64       36kB\n","  + uc-micro-py                           1.0.1  pyhd8ed1ab_0                       conda-forge/noarch          9kB\n","  + ucx                                  1.14.1  h64cca9d_5                         conda-forge/linux-64       15MB\n","  + ucx-proc                              1.0.0  gpu                                rapidsai/linux-64           9kB\n","  + ucx-py                              0.34.00  py310_231011_g17dceab_0            rapidsai/linux-64         474kB\n","  + unicodedata2                         15.1.0  py310h2372a71_0                    conda-forge/linux-64      374kB\n","  + uri-template                          1.3.0  pyhd8ed1ab_0                       conda-forge/noarch         24kB\n","  + uriparser                             0.9.7  hcb278e6_1                         conda-forge/linux-64       47kB\n","  + uvicorn                              0.24.0  py310hff52083_0                    conda-forge/linux-64       97kB\n","  + wcwidth                              0.2.10  pyhd8ed1ab_0                       conda-forge/noarch         33kB\n","  + webcolors                              1.13  pyhd8ed1ab_0                       conda-forge/noarch         18kB\n","  + webencodings                          0.5.1  pyhd8ed1ab_2                       conda-forge/noarch         16kB\n","  + websocket-client                      1.6.4  pyhd8ed1ab_0                       conda-forge/noarch         46kB\n","  + websockets                             10.4  py310h5764c6d_1                    conda-forge/linux-64      129kB\n","  + xarray                            2023.10.1  pyhd8ed1ab_0                       conda-forge/noarch        711kB\n","  + xerces-c                              3.2.4  h8d71039_2                         conda-forge/linux-64        2MB\n","  + xgboost                               1.7.6  rapidsai_py310h1395376_2310        rapidsai/linux-64          16kB\n","  + xorg-kbproto                          1.0.7  h7f98852_1002                      conda-forge/linux-64       27kB\n","  + xorg-libice                           1.1.1  hd590300_0                         conda-forge/linux-64       58kB\n","  + xorg-libsm                            1.2.4  h7391055_0                         conda-forge/linux-64       27kB\n","  + xorg-libx11                           1.8.7  h8ee46fc_0                         conda-forge/linux-64      829kB\n","  + xorg-libxau                          1.0.11  hd590300_0                         conda-forge/linux-64       14kB\n","  + xorg-libxdmcp                         1.1.3  h7f98852_0                         conda-forge/linux-64       19kB\n","  + xorg-libxext                          1.3.4  h0b41bf4_2                         conda-forge/linux-64       50kB\n","  + xorg-libxrender                      0.9.11  hd590300_0                         conda-forge/linux-64       38kB\n","  + xorg-renderproto                     0.11.1  h7f98852_1002                      conda-forge/linux-64       10kB\n","  + xorg-xextproto                        7.3.0  h0b41bf4_1003                      conda-forge/linux-64       30kB\n","  + xorg-xproto                          7.0.31  h7f98852_1007                      conda-forge/linux-64       75kB\n","  + xyzservices                       2023.10.1  pyhd8ed1ab_0                       conda-forge/noarch         36kB\n","  + yaml                                  0.2.5  h7f98852_2                         conda-forge/linux-64       89kB\n","  + yarl                                  1.9.2  py310h2372a71_1                    conda-forge/linux-64       98kB\n","  + zeromq                                4.3.5  h59595ed_0                         conda-forge/linux-64      343kB\n","  + zict                                  3.0.0  pyhd8ed1ab_0                       conda-forge/noarch         36kB\n","  + zipp                                 3.17.0  pyhd8ed1ab_0                       conda-forge/noarch         19kB\n","  + zlib                                 1.2.13  h166bdaf_4                         conda-forge/linux-64       94kB\n","\n","  Change:\n","â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n","\n","  - libarchive                            3.6.2  h3d51595_0                         conda-forge\n","  + libarchive                            3.6.2  h039dbb9_1                         conda-forge/linux-64      844kB\n","  - libmamba                              1.4.1  hcea66bb_0                         conda-forge\n","  + libmamba                              1.4.1  hcea66bb_0                         conda-forge/linux-64     Cached\n","\n","  Upgrade:\n","â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n","\n","  - krb5                                 1.20.1  h81ceb04_0                         conda-forge\n","  + krb5                                 1.21.2  h659d440_0                         conda-forge/linux-64        1MB\n","  - libcurl                              7.88.1  hdc1c0ab_1                         conda-forge\n","  + libcurl                               8.4.0  hca28451_0                         conda-forge/linux-64      386kB\n","  - libsqlite                            3.40.0  h753d276_0                         conda-forge\n","  + libsqlite                            3.44.0  h2797004_0                         conda-forge/linux-64      846kB\n","  - libssh2                              1.10.0  hf14f497_3                         conda-forge\n","  + libssh2                              1.11.0  h0841786_0                         conda-forge/linux-64      271kB\n","  - libxml2                              2.10.3  hfdac1af_6                         conda-forge\n","  + libxml2                              2.11.5  h0d562d8_0                         conda-forge/linux-64      705kB\n","  - zstd                                  1.5.2  h3eb15da_6                         conda-forge\n","  + zstd                                  1.5.5  hfc55251_0                         conda-forge/linux-64      545kB\n","\n","  Summary:\n","\n","  Install: 385 packages\n","  Change: 2 packages\n","  Upgrade: 6 packages\n","\n","  Total download: 5GB\n","\n","â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n","\n","\n","\n","Looking for: ['python=3.10', 'cudatoolkit=11.8', 'rapids=23.10', 'llvmlite', 'gcsfs', 'openssl', 'dask-sql']\n","\n","\n","Pinned packages:\n","  - python 3.10.*\n","  - python_abi 3.10.* *cp310*\n","  - cudatoolkit 11.8.*\n","\n","\n","\n","Downloading and Extracting Packages\n","\n","Preparing transaction: ...working... done\n","Verifying transaction: ...working... done\n","Executing transaction: ...working... By downloading and using the CUDA Toolkit conda packages, you accept the terms and conditions of the CUDA End User License Agreement (EULA): https://docs.nvidia.com/cuda/eula/index.html\n","\n","\n","By downloading and using the CubinLinker conda packages, you accept the terms and conditions of the CubinLinker License Agreement: https://docs.rapids.ai/licenses/CubinLinker.txt\n","\n","done\n","RAPIDS conda installation complete.  Updating Colab's libraries...\n","Copying /usr/local/lib/libcudf.so to /usr/lib/libcudf.so\n","Copying /usr/local/lib/libnccl.so to /usr/lib/libnccl.so\n","Copying /usr/local/lib/libcuml.so to /usr/lib/libcuml.so\n","Copying /usr/local/lib/libcugraph.so to /usr/lib/libcugraph.so\n","Copying /usr/local/lib/libxgboost.so to /usr/lib/libxgboost.so\n","Copying /usr/local/lib/libcuspatial.so to /usr/lib/libcuspatial.so\n","Copying /usr/local/lib/libgeos.so to /usr/lib/libgeos.so\n","Copying /usr/local/lib/libgeos_c.so to /usr/lib/libgeos_c.so\n"]}],"source":["# Installing RAPIDS is now 'python rapidsai-csp-utils/colab/install_rapids.py <release> <packages>'\n","# The <release> options are 'stable' and 'nightly'.  Leaving it blank or adding any other words will default to stable.\n","!python rapidsai-csp-utils/colab/install_rapids.py stable\n","import os\n","os.environ['NUMBAPRO_NVVM'] = '/usr/local/cuda/nvvm/lib64/libnvvm.so'\n","os.environ['NUMBAPRO_LIBDEVICE'] = '/usr/local/cuda/nvvm/libdevice/'\n","os.environ['CONDA_PREFIX'] = '/usr/local'"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":6002,"status":"ok","timestamp":1700214654804,"user":{"displayName":"Sathya Raminani","userId":"13681115488434516434"},"user_tz":480},"id":"ApyVsGFnbgYf","outputId":"fedda8d0-fd4b-468e-a472-859b2de1aa83"},"outputs":[{"output_type":"stream","name":"stdout","text":["Requirement already satisfied: joblib in /usr/local/lib/python3.10/site-packages (1.3.2)\n","\u001b[33mWARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv\u001b[0m\u001b[33m\n","\u001b[0m"]}],"source":["!pip install joblib"]},{"cell_type":"markdown","metadata":{"id":"RUVWaI7Vbkpn"},"source":["###Libarary and Data Imports"]},{"cell_type":"code","execution_count":3,"metadata":{"executionInfo":{"elapsed":18328,"status":"ok","timestamp":1700265283317,"user":{"displayName":"Sathya Raminani","userId":"13681115488434516434"},"user_tz":480},"id":"2YAJWSO8biiL"},"outputs":[],"source":["import numpy as np\n","import pandas as pd\n","import matplotlib.pyplot as plt\n","import pickle\n","\n","import torch\n","\n","import cuml\n","import cupy as cp\n","from cuml.svm import SVR\n","from cuml.ensemble import RandomForestRegressor\n","from cuml.metrics.regression import r2_score, mean_squared_error"]},{"cell_type":"code","execution_count":4,"metadata":{"executionInfo":{"elapsed":41824,"status":"ok","timestamp":1700265325127,"user":{"displayName":"Sathya Raminani","userId":"13681115488434516434"},"user_tz":480},"id":"pLUh3rbVbokL"},"outputs":[],"source":["#Importing ecfp4 and ecfp6 train and test data\n","ecfp4_train = pd.read_pickle('/content/drive/MyDrive/Katritch Lab/ecfp4_512_train.pkl')\n","ecfp4_test = pd.read_pickle('/content/drive/MyDrive/Katritch Lab/ecfp4_512_test.pkl')\n","\n","ecfp6_train = pd.read_pickle('/content/drive/MyDrive/Katritch Lab/ecfp6_1024_train.pkl')\n","ecfp6_test = pd.read_pickle('/content/drive/MyDrive/Katritch Lab/ecfp6_1024_test.pkl')"]},{"cell_type":"code","execution_count":5,"metadata":{"executionInfo":{"elapsed":31,"status":"ok","timestamp":1700265325128,"user":{"displayName":"Sathya Raminani","userId":"13681115488434516434"},"user_tz":480},"id":"Y000q5nrg0iE"},"outputs":[],"source":["#Storage for models\n","serotonin_models = {'5HT1A': 'placeholder', '5HT1B': 'placeholder', '5HT1D': 'placeholder', '5HT2A': 'placeholder',\n","                    '5HT2B': 'placeholder', '5HT2C': 'placeholder', '5HT4R': 'placeholder', '5HT5A': 'placeholder',\n","                    '5HT6R': 'placeholder', '5HT7R': 'placeholder', '5HT1E': 'placeholder', '5HT1F': 'placeholder'\n","                    }\n","\n","\n","muscarinic_models = {'ACM1': 'placeholder', 'ACM2': 'placeholder', 'ACM3': 'placeholder', 'ACM4': 'placeholder',\n","                     'ACM5': 'placeholder'}\n","\n","histamine_models = {'HRH1': 'placeholder', 'HRH2': 'placeholder', 'HRH3': 'placeholder', 'HRH4': 'placeholder'}\n","\n","dopamine_models = {'DRD1': 'placeholder', 'DRD2': 'placeholder', 'DRD3': 'placeholder', 'DRD4': 'placeholder',\n","                   'DRD5': 'placeholder'}\n","\n","adrenoceptor_models = {'ADA1A': 'placeholder', 'ADA1B': 'placeholder', 'ADA1D': 'placeholder', 'ADA2A': 'placeholder',\n","                       'ADA2B': 'placeholder', 'ADA2C': 'placeholder', 'ADRB1': 'placeholder', 'ADRB2': 'placeholder',\n","                       'ADRB3': 'placeholder'}"]},{"cell_type":"markdown","metadata":{"id":"sZ9WyUJShB2v"},"source":["###SVR and RFR Training and Evaluation"]},{"cell_type":"code","execution_count":6,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":206},"executionInfo":{"elapsed":29,"status":"ok","timestamp":1700265325128,"user":{"displayName":"Sathya Raminani","userId":"13681115488434516434"},"user_tz":480},"id":"8H7_gUNYhEEO","outputId":"3d8b09b1-86c1-492c-f12c-5a576331d18d"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["                                               ecfp4   pAct Receptor  \\\n","0  [tensor(0.), tensor(0.), tensor(0.), tensor(1....  0.360    5HT1A   \n","1  [tensor(1.), tensor(0.), tensor(0.), tensor(0....  2.542    5HT1A   \n","2  [tensor(0.), tensor(0.), tensor(0.), tensor(0....  2.556    5HT1A   \n","3  [tensor(1.), tensor(0.), tensor(0.), tensor(0....  2.851    5HT1A   \n","4  [tensor(1.), tensor(0.), tensor(0.), tensor(0....  2.876    5HT1A   \n","\n","  Receptor Family  \n","0       Serotonin  \n","1       Serotonin  \n","2       Serotonin  \n","3       Serotonin  \n","4       Serotonin  "],"text/html":["\n","  <div id=\"df-239a09ec-e234-409c-b2d2-23e112f1463c\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>ecfp4</th>\n","      <th>pAct</th>\n","      <th>Receptor</th>\n","      <th>Receptor Family</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>[tensor(0.), tensor(0.), tensor(0.), tensor(1....</td>\n","      <td>0.360</td>\n","      <td>5HT1A</td>\n","      <td>Serotonin</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>[tensor(1.), tensor(0.), tensor(0.), tensor(0....</td>\n","      <td>2.542</td>\n","      <td>5HT1A</td>\n","      <td>Serotonin</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>[tensor(0.), tensor(0.), tensor(0.), tensor(0....</td>\n","      <td>2.556</td>\n","      <td>5HT1A</td>\n","      <td>Serotonin</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>[tensor(1.), tensor(0.), tensor(0.), tensor(0....</td>\n","      <td>2.851</td>\n","      <td>5HT1A</td>\n","      <td>Serotonin</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>[tensor(1.), tensor(0.), tensor(0.), tensor(0....</td>\n","      <td>2.876</td>\n","      <td>5HT1A</td>\n","      <td>Serotonin</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-239a09ec-e234-409c-b2d2-23e112f1463c')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-239a09ec-e234-409c-b2d2-23e112f1463c button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-239a09ec-e234-409c-b2d2-23e112f1463c');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","<div id=\"df-9c1fa720-6ded-47ad-958e-2e560c4e2927\">\n","  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-9c1fa720-6ded-47ad-958e-2e560c4e2927')\"\n","            title=\"Suggest charts\"\n","            style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","  </button>\n","\n","<style>\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","</style>\n","\n","  <script>\n","    async function quickchart(key) {\n","      const quickchartButtonEl =\n","        document.querySelector('#' + key + ' button');\n","      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","      quickchartButtonEl.classList.add('colab-df-spinner');\n","      try {\n","        const charts = await google.colab.kernel.invokeFunction(\n","            'suggestCharts', [key], {});\n","      } catch (error) {\n","        console.error('Error during call to suggestCharts:', error);\n","      }\n","      quickchartButtonEl.classList.remove('colab-df-spinner');\n","      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","    }\n","    (() => {\n","      let quickchartButtonEl =\n","        document.querySelector('#df-9c1fa720-6ded-47ad-958e-2e560c4e2927 button');\n","      quickchartButtonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","    })();\n","  </script>\n","</div>\n","\n","    </div>\n","  </div>\n"]},"metadata":{},"execution_count":6}],"source":["ecfp4_train.head()"]},{"cell_type":"code","execution_count":7,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":206},"executionInfo":{"elapsed":594,"status":"ok","timestamp":1700265325709,"user":{"displayName":"Sathya Raminani","userId":"13681115488434516434"},"user_tz":480},"id":"-hsSyA11hpKu","outputId":"8d40c647-39d0-445d-a037-d5456d1cf610"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["                                               ecfp6   pAct Receptor  \\\n","0  [tensor(0.), tensor(0.), tensor(0.), tensor(1....  0.360    5HT1A   \n","1  [tensor(0.), tensor(0.), tensor(0.), tensor(0....  2.542    5HT1A   \n","2  [tensor(0.), tensor(0.), tensor(0.), tensor(0....  2.556    5HT1A   \n","3  [tensor(0.), tensor(0.), tensor(0.), tensor(0....  2.851    5HT1A   \n","4  [tensor(0.), tensor(0.), tensor(0.), tensor(0....  2.876    5HT1A   \n","\n","  Receptor Family  \n","0       Serotonin  \n","1       Serotonin  \n","2       Serotonin  \n","3       Serotonin  \n","4       Serotonin  "],"text/html":["\n","  <div id=\"df-d0e0e858-c9bb-48c0-8c48-15e49b859874\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>ecfp6</th>\n","      <th>pAct</th>\n","      <th>Receptor</th>\n","      <th>Receptor Family</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>[tensor(0.), tensor(0.), tensor(0.), tensor(1....</td>\n","      <td>0.360</td>\n","      <td>5HT1A</td>\n","      <td>Serotonin</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>[tensor(0.), tensor(0.), tensor(0.), tensor(0....</td>\n","      <td>2.542</td>\n","      <td>5HT1A</td>\n","      <td>Serotonin</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>[tensor(0.), tensor(0.), tensor(0.), tensor(0....</td>\n","      <td>2.556</td>\n","      <td>5HT1A</td>\n","      <td>Serotonin</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>[tensor(0.), tensor(0.), tensor(0.), tensor(0....</td>\n","      <td>2.851</td>\n","      <td>5HT1A</td>\n","      <td>Serotonin</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>[tensor(0.), tensor(0.), tensor(0.), tensor(0....</td>\n","      <td>2.876</td>\n","      <td>5HT1A</td>\n","      <td>Serotonin</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-d0e0e858-c9bb-48c0-8c48-15e49b859874')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-d0e0e858-c9bb-48c0-8c48-15e49b859874 button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-d0e0e858-c9bb-48c0-8c48-15e49b859874');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","<div id=\"df-761548a9-2d0c-4223-9b64-a95cb7d4a512\">\n","  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-761548a9-2d0c-4223-9b64-a95cb7d4a512')\"\n","            title=\"Suggest charts\"\n","            style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","  </button>\n","\n","<style>\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","</style>\n","\n","  <script>\n","    async function quickchart(key) {\n","      const quickchartButtonEl =\n","        document.querySelector('#' + key + ' button');\n","      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","      quickchartButtonEl.classList.add('colab-df-spinner');\n","      try {\n","        const charts = await google.colab.kernel.invokeFunction(\n","            'suggestCharts', [key], {});\n","      } catch (error) {\n","        console.error('Error during call to suggestCharts:', error);\n","      }\n","      quickchartButtonEl.classList.remove('colab-df-spinner');\n","      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","    }\n","    (() => {\n","      let quickchartButtonEl =\n","        document.querySelector('#df-761548a9-2d0c-4223-9b64-a95cb7d4a512 button');\n","      quickchartButtonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","    })();\n","  </script>\n","</div>\n","\n","    </div>\n","  </div>\n"]},"metadata":{},"execution_count":7}],"source":["ecfp6_train.head()"]},{"cell_type":"code","execution_count":8,"metadata":{"executionInfo":{"elapsed":15,"status":"ok","timestamp":1700265325710,"user":{"displayName":"Sathya Raminani","userId":"13681115488434516434"},"user_tz":480},"id":"6Y1aZunvhu3w"},"outputs":[],"source":["#Functions to retrieve data by receptor or receptor family\n","def get_data_by_receptor(train_data, test_data, receptor):\n","  return train_data[train_data['Receptor'] == receptor], test_data[test_data['Receptor'] == receptor]\n","\n","def get_data_by_receptor_family(train_data, test_data, receptor_family):\n","  return train_data[train_data['Receptor Family'] == receptor_family], test_data[test_data['Receptor Family'] == receptor_family]"]},{"cell_type":"code","execution_count":9,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":395},"executionInfo":{"elapsed":14,"status":"ok","timestamp":1700265325710,"user":{"displayName":"Sathya Raminani","userId":"13681115488434516434"},"user_tz":480},"id":"ofzv7rDahwaA","outputId":"97d6fdf1-710a-4a3a-aa9a-1b872a4fa08f"},"outputs":[{"output_type":"display_data","data":{"text/plain":["                                               ecfp4   pAct Receptor  \\\n","0  [tensor(0.), tensor(0.), tensor(0.), tensor(1....  0.360    5HT1A   \n","1  [tensor(1.), tensor(0.), tensor(0.), tensor(0....  2.542    5HT1A   \n","2  [tensor(0.), tensor(0.), tensor(0.), tensor(0....  2.556    5HT1A   \n","3  [tensor(1.), tensor(0.), tensor(0.), tensor(0....  2.851    5HT1A   \n","4  [tensor(1.), tensor(0.), tensor(0.), tensor(0....  2.876    5HT1A   \n","\n","  Receptor Family  \n","0       Serotonin  \n","1       Serotonin  \n","2       Serotonin  \n","3       Serotonin  \n","4       Serotonin  "],"text/html":["\n","  <div id=\"df-7e9a6e06-2fc3-41dc-b21c-3e32c25bdd84\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>ecfp4</th>\n","      <th>pAct</th>\n","      <th>Receptor</th>\n","      <th>Receptor Family</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>[tensor(0.), tensor(0.), tensor(0.), tensor(1....</td>\n","      <td>0.360</td>\n","      <td>5HT1A</td>\n","      <td>Serotonin</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>[tensor(1.), tensor(0.), tensor(0.), tensor(0....</td>\n","      <td>2.542</td>\n","      <td>5HT1A</td>\n","      <td>Serotonin</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>[tensor(0.), tensor(0.), tensor(0.), tensor(0....</td>\n","      <td>2.556</td>\n","      <td>5HT1A</td>\n","      <td>Serotonin</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>[tensor(1.), tensor(0.), tensor(0.), tensor(0....</td>\n","      <td>2.851</td>\n","      <td>5HT1A</td>\n","      <td>Serotonin</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>[tensor(1.), tensor(0.), tensor(0.), tensor(0....</td>\n","      <td>2.876</td>\n","      <td>5HT1A</td>\n","      <td>Serotonin</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-7e9a6e06-2fc3-41dc-b21c-3e32c25bdd84')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-7e9a6e06-2fc3-41dc-b21c-3e32c25bdd84 button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-7e9a6e06-2fc3-41dc-b21c-3e32c25bdd84');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","<div id=\"df-53ac6a21-aff0-4eaa-b8ce-e58d9069e75e\">\n","  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-53ac6a21-aff0-4eaa-b8ce-e58d9069e75e')\"\n","            title=\"Suggest charts\"\n","            style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","  </button>\n","\n","<style>\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","</style>\n","\n","  <script>\n","    async function quickchart(key) {\n","      const quickchartButtonEl =\n","        document.querySelector('#' + key + ' button');\n","      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","      quickchartButtonEl.classList.add('colab-df-spinner');\n","      try {\n","        const charts = await google.colab.kernel.invokeFunction(\n","            'suggestCharts', [key], {});\n","      } catch (error) {\n","        console.error('Error during call to suggestCharts:', error);\n","      }\n","      quickchartButtonEl.classList.remove('colab-df-spinner');\n","      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","    }\n","    (() => {\n","      let quickchartButtonEl =\n","        document.querySelector('#df-53ac6a21-aff0-4eaa-b8ce-e58d9069e75e button');\n","      quickchartButtonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","    })();\n","  </script>\n","</div>\n","\n","    </div>\n","  </div>\n"]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["                                                ecfp4   pAct Receptor  \\\n","30  [tensor(0.), tensor(0.), tensor(0.), tensor(0....  4.057    5HT1A   \n","31  [tensor(0.), tensor(0.), tensor(0.), tensor(0....  4.071    5HT1A   \n","32  [tensor(0.), tensor(0.), tensor(0.), tensor(0....  4.112    5HT1A   \n","40  [tensor(0.), tensor(1.), tensor(0.), tensor(0....  4.264    5HT1A   \n","43  [tensor(0.), tensor(1.), tensor(0.), tensor(0....  4.290    5HT1A   \n","\n","   Receptor Family  \n","30       Serotonin  \n","31       Serotonin  \n","32       Serotonin  \n","40       Serotonin  \n","43       Serotonin  "],"text/html":["\n","  <div id=\"df-af876248-fec0-4d30-b527-852abbf77933\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>ecfp4</th>\n","      <th>pAct</th>\n","      <th>Receptor</th>\n","      <th>Receptor Family</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>30</th>\n","      <td>[tensor(0.), tensor(0.), tensor(0.), tensor(0....</td>\n","      <td>4.057</td>\n","      <td>5HT1A</td>\n","      <td>Serotonin</td>\n","    </tr>\n","    <tr>\n","      <th>31</th>\n","      <td>[tensor(0.), tensor(0.), tensor(0.), tensor(0....</td>\n","      <td>4.071</td>\n","      <td>5HT1A</td>\n","      <td>Serotonin</td>\n","    </tr>\n","    <tr>\n","      <th>32</th>\n","      <td>[tensor(0.), tensor(0.), tensor(0.), tensor(0....</td>\n","      <td>4.112</td>\n","      <td>5HT1A</td>\n","      <td>Serotonin</td>\n","    </tr>\n","    <tr>\n","      <th>40</th>\n","      <td>[tensor(0.), tensor(1.), tensor(0.), tensor(0....</td>\n","      <td>4.264</td>\n","      <td>5HT1A</td>\n","      <td>Serotonin</td>\n","    </tr>\n","    <tr>\n","      <th>43</th>\n","      <td>[tensor(0.), tensor(1.), tensor(0.), tensor(0....</td>\n","      <td>4.290</td>\n","      <td>5HT1A</td>\n","      <td>Serotonin</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-af876248-fec0-4d30-b527-852abbf77933')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-af876248-fec0-4d30-b527-852abbf77933 button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-af876248-fec0-4d30-b527-852abbf77933');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","<div id=\"df-65bd5588-dacb-4767-b3c2-3d13860cc1ad\">\n","  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-65bd5588-dacb-4767-b3c2-3d13860cc1ad')\"\n","            title=\"Suggest charts\"\n","            style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","  </button>\n","\n","<style>\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","</style>\n","\n","  <script>\n","    async function quickchart(key) {\n","      const quickchartButtonEl =\n","        document.querySelector('#' + key + ' button');\n","      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","      quickchartButtonEl.classList.add('colab-df-spinner');\n","      try {\n","        const charts = await google.colab.kernel.invokeFunction(\n","            'suggestCharts', [key], {});\n","      } catch (error) {\n","        console.error('Error during call to suggestCharts:', error);\n","      }\n","      quickchartButtonEl.classList.remove('colab-df-spinner');\n","      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","    }\n","    (() => {\n","      let quickchartButtonEl =\n","        document.querySelector('#df-65bd5588-dacb-4767-b3c2-3d13860cc1ad button');\n","      quickchartButtonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","    })();\n","  </script>\n","</div>\n","\n","    </div>\n","  </div>\n"]},"metadata":{}}],"source":["#Getting 5HT1A ecfp4 data\n","ecfp4_train_5HT1A, ecfp4_test_5HT1A = get_data_by_receptor(ecfp4_train, ecfp4_test, '5HT1A')\n","display(ecfp4_train_5HT1A.head())\n","display(ecfp4_test_5HT1A.head())"]},{"cell_type":"code","execution_count":10,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":395},"executionInfo":{"elapsed":1085,"status":"ok","timestamp":1700265326782,"user":{"displayName":"Sathya Raminani","userId":"13681115488434516434"},"user_tz":480},"id":"kHGKcJpJiDlo","outputId":"eb0645ad-7a6f-494f-85e2-8f1a8c03b37a"},"outputs":[{"output_type":"display_data","data":{"text/plain":["                                               ecfp6   pAct Receptor  \\\n","0  [tensor(0.), tensor(0.), tensor(0.), tensor(1....  0.360    5HT1A   \n","1  [tensor(0.), tensor(0.), tensor(0.), tensor(0....  2.542    5HT1A   \n","2  [tensor(0.), tensor(0.), tensor(0.), tensor(0....  2.556    5HT1A   \n","3  [tensor(0.), tensor(0.), tensor(0.), tensor(0....  2.851    5HT1A   \n","4  [tensor(0.), tensor(0.), tensor(0.), tensor(0....  2.876    5HT1A   \n","\n","  Receptor Family  \n","0       Serotonin  \n","1       Serotonin  \n","2       Serotonin  \n","3       Serotonin  \n","4       Serotonin  "],"text/html":["\n","  <div id=\"df-23c23d5c-3ea5-4223-a4b4-a751c9403f98\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>ecfp6</th>\n","      <th>pAct</th>\n","      <th>Receptor</th>\n","      <th>Receptor Family</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>[tensor(0.), tensor(0.), tensor(0.), tensor(1....</td>\n","      <td>0.360</td>\n","      <td>5HT1A</td>\n","      <td>Serotonin</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>[tensor(0.), tensor(0.), tensor(0.), tensor(0....</td>\n","      <td>2.542</td>\n","      <td>5HT1A</td>\n","      <td>Serotonin</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>[tensor(0.), tensor(0.), tensor(0.), tensor(0....</td>\n","      <td>2.556</td>\n","      <td>5HT1A</td>\n","      <td>Serotonin</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>[tensor(0.), tensor(0.), tensor(0.), tensor(0....</td>\n","      <td>2.851</td>\n","      <td>5HT1A</td>\n","      <td>Serotonin</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>[tensor(0.), tensor(0.), tensor(0.), tensor(0....</td>\n","      <td>2.876</td>\n","      <td>5HT1A</td>\n","      <td>Serotonin</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-23c23d5c-3ea5-4223-a4b4-a751c9403f98')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-23c23d5c-3ea5-4223-a4b4-a751c9403f98 button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-23c23d5c-3ea5-4223-a4b4-a751c9403f98');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","<div id=\"df-f0efdb42-3201-4637-9f61-694465e56216\">\n","  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-f0efdb42-3201-4637-9f61-694465e56216')\"\n","            title=\"Suggest charts\"\n","            style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","  </button>\n","\n","<style>\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","</style>\n","\n","  <script>\n","    async function quickchart(key) {\n","      const quickchartButtonEl =\n","        document.querySelector('#' + key + ' button');\n","      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","      quickchartButtonEl.classList.add('colab-df-spinner');\n","      try {\n","        const charts = await google.colab.kernel.invokeFunction(\n","            'suggestCharts', [key], {});\n","      } catch (error) {\n","        console.error('Error during call to suggestCharts:', error);\n","      }\n","      quickchartButtonEl.classList.remove('colab-df-spinner');\n","      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","    }\n","    (() => {\n","      let quickchartButtonEl =\n","        document.querySelector('#df-f0efdb42-3201-4637-9f61-694465e56216 button');\n","      quickchartButtonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","    })();\n","  </script>\n","</div>\n","\n","    </div>\n","  </div>\n"]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["                                                ecfp6   pAct Receptor  \\\n","30  [tensor(0.), tensor(0.), tensor(0.), tensor(0....  4.057    5HT1A   \n","31  [tensor(0.), tensor(0.), tensor(0.), tensor(0....  4.071    5HT1A   \n","32  [tensor(0.), tensor(0.), tensor(0.), tensor(0....  4.112    5HT1A   \n","40  [tensor(0.), tensor(1.), tensor(0.), tensor(0....  4.264    5HT1A   \n","43  [tensor(0.), tensor(1.), tensor(0.), tensor(0....  4.290    5HT1A   \n","\n","   Receptor Family  \n","30       Serotonin  \n","31       Serotonin  \n","32       Serotonin  \n","40       Serotonin  \n","43       Serotonin  "],"text/html":["\n","  <div id=\"df-39f3b253-e81f-4d07-9163-917d82a6ee12\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>ecfp6</th>\n","      <th>pAct</th>\n","      <th>Receptor</th>\n","      <th>Receptor Family</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>30</th>\n","      <td>[tensor(0.), tensor(0.), tensor(0.), tensor(0....</td>\n","      <td>4.057</td>\n","      <td>5HT1A</td>\n","      <td>Serotonin</td>\n","    </tr>\n","    <tr>\n","      <th>31</th>\n","      <td>[tensor(0.), tensor(0.), tensor(0.), tensor(0....</td>\n","      <td>4.071</td>\n","      <td>5HT1A</td>\n","      <td>Serotonin</td>\n","    </tr>\n","    <tr>\n","      <th>32</th>\n","      <td>[tensor(0.), tensor(0.), tensor(0.), tensor(0....</td>\n","      <td>4.112</td>\n","      <td>5HT1A</td>\n","      <td>Serotonin</td>\n","    </tr>\n","    <tr>\n","      <th>40</th>\n","      <td>[tensor(0.), tensor(1.), tensor(0.), tensor(0....</td>\n","      <td>4.264</td>\n","      <td>5HT1A</td>\n","      <td>Serotonin</td>\n","    </tr>\n","    <tr>\n","      <th>43</th>\n","      <td>[tensor(0.), tensor(1.), tensor(0.), tensor(0....</td>\n","      <td>4.290</td>\n","      <td>5HT1A</td>\n","      <td>Serotonin</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-39f3b253-e81f-4d07-9163-917d82a6ee12')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-39f3b253-e81f-4d07-9163-917d82a6ee12 button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-39f3b253-e81f-4d07-9163-917d82a6ee12');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","<div id=\"df-a23675d6-d13f-4ccb-9f64-d13c0abc7ae3\">\n","  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-a23675d6-d13f-4ccb-9f64-d13c0abc7ae3')\"\n","            title=\"Suggest charts\"\n","            style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","  </button>\n","\n","<style>\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","</style>\n","\n","  <script>\n","    async function quickchart(key) {\n","      const quickchartButtonEl =\n","        document.querySelector('#' + key + ' button');\n","      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","      quickchartButtonEl.classList.add('colab-df-spinner');\n","      try {\n","        const charts = await google.colab.kernel.invokeFunction(\n","            'suggestCharts', [key], {});\n","      } catch (error) {\n","        console.error('Error during call to suggestCharts:', error);\n","      }\n","      quickchartButtonEl.classList.remove('colab-df-spinner');\n","      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","    }\n","    (() => {\n","      let quickchartButtonEl =\n","        document.querySelector('#df-a23675d6-d13f-4ccb-9f64-d13c0abc7ae3 button');\n","      quickchartButtonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","    })();\n","  </script>\n","</div>\n","\n","    </div>\n","  </div>\n"]},"metadata":{}}],"source":["#Getting 5HT1A ecfp6 data\n","ecfp6_train_5HT1A, ecfp6_test_5HT1A = get_data_by_receptor(ecfp6_train, ecfp6_test, '5HT1A')\n","display(ecfp6_train_5HT1A.head())\n","display(ecfp6_test_5HT1A.head())"]},{"cell_type":"code","execution_count":11,"metadata":{"executionInfo":{"elapsed":18,"status":"ok","timestamp":1700265326783,"user":{"displayName":"Sathya Raminani","userId":"13681115488434516434"},"user_tz":480},"id":"jPDq2OwjkZdQ"},"outputs":[],"source":["#Function to convert train data to format suitable for training cuML algorithms\n","def convert_to_cupy(inputs, targets):\n","  input_tensor_list = inputs.tolist()\n","  input_stacked_tensor = torch.stack(input_tensor_list)\n","  inputs = cp.asarray(input_stacked_tensor)\n","\n","  targets = cp.asarray(targets)\n","\n","  return inputs, targets"]},{"cell_type":"code","execution_count":12,"metadata":{"executionInfo":{"elapsed":14359,"status":"ok","timestamp":1700265341125,"user":{"displayName":"Sathya Raminani","userId":"13681115488434516434"},"user_tz":480},"id":"WjC7_I0siYdT"},"outputs":[],"source":["#Testing on 5HT1A ecfp4 dataset\n","X_train_ecfp4 = ecfp4_train_5HT1A['ecfp4']\n","y_train_ecfp4 = ecfp4_train_5HT1A['pAct']\n","\n","X_test_ecfp4 = ecfp4_test_5HT1A['ecfp4']\n","y_test_ecfp4 = ecfp4_test_5HT1A['pAct']\n","\n","X_train_ecfp4, y_train_ecfp4 = convert_to_cupy(X_train_ecfp4, y_train_ecfp4)\n","X_test_ecfp4, y_test_ecfp4 = convert_to_cupy(X_test_ecfp4, y_test_ecfp4)"]},{"cell_type":"code","execution_count":13,"metadata":{"executionInfo":{"elapsed":29,"status":"ok","timestamp":1700265341125,"user":{"displayName":"Sathya Raminani","userId":"13681115488434516434"},"user_tz":480},"id":"MHc0VSLJmf_Q"},"outputs":[],"source":["#Testing on 5HT1A ecfp6 dataset\n","X_train_ecfp6 = ecfp6_train_5HT1A['ecfp6']\n","y_train_ecfp6 = ecfp6_train_5HT1A['pAct']\n","\n","X_test_ecfp6 = ecfp6_test_5HT1A['ecfp6']\n","y_test_ecfp6 = ecfp6_test_5HT1A['pAct']\n","\n","X_train_ecfp6, y_train_ecfp6 = convert_to_cupy(X_train_ecfp6, y_train_ecfp6)\n","X_test_ecfp6, y_test_ecfp6 = convert_to_cupy(X_test_ecfp6, y_test_ecfp6)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"Tq71SVHKmscG","outputId":"0e69825a-9aba-4aa8-f554-d4f7aeb59046","executionInfo":{"status":"ok","timestamp":1700221033570,"user_tz":480,"elapsed":4372388,"user":{"displayName":"Sathya Raminani","userId":"13681115488434516434"}}},"outputs":[{"output_type":"stream","name":"stdout","text":["Best SVR Parameters:  {'C': 1, 'gamma': 'scale', 'kernel': 'linear'}\n","Best RFR Parameters:  {'max_depth': 30, 'min_samples_leaf': 4, 'min_samples_split': 10, 'n_estimators': 300}\n"]}],"source":["#Identifying optimal parameters for SVR and RFR (ecfp4)\n","from cuml.model_selection import GridSearchCV\n","\n","# Set up the hyperparameter grid for SVR\n","svr_params = {\n","    'C': [0.1, 1, 10],\n","    'gamma': ['scale', 'auto'],\n","    'kernel': ['linear', 'rbf']\n","}\n","\n","# Grid search for SVR\n","svr_search = GridSearchCV(SVR(), svr_params)\n","svr_search.fit(X_train_ecfp4, y_train_ecfp4)\n","\n","# Get the best parameters and best model\n","best_svr_params_ecfp4 = svr_search.best_params_\n","best_svr_model_ecfp4 = svr_search.best_estimator_\n","\n","print(\"Best SVR Parameters: \", best_svr_params_ecfp4)\n","\n","# Set up hyperparameter grid for RFR\n","rfr_params = {\n","    'n_estimators': [100, 200, 300],\n","    'max_depth': [10, 20, 30],\n","    'min_samples_split': [2, 5, 10],\n","    'min_samples_leaf': [1, 2, 4]\n","}\n","\n","# Set up the grid search with cross-validation\n","rfr_search = GridSearchCV(RandomForestRegressor(), rfr_params)\n","rfr_search.fit(X_train_ecfp4, y_train_ecfp4)\n","\n","# Get the best parameters and best model\n","best_rfr_params_ecfp4 = rfr_search.best_params_\n","best_rfr_model_ecfp4 = rfr_search.best_estimator_\n","\n","print(\"Best RFR Parameters: \", best_rfr_params_ecfp4)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"OeqHEXJ0nfnz","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1700229762279,"user_tz":480,"elapsed":8728712,"user":{"displayName":"Sathya Raminani","userId":"13681115488434516434"}},"outputId":"1f18acd3-9eba-463e-9b4d-cc42e49df276"},"outputs":[{"output_type":"stream","name":"stdout","text":["Best SVR Parameters:  {'C': 1, 'gamma': 'scale', 'kernel': 'linear'}\n","Best RFR Parameters:  {'max_depth': 30, 'min_samples_leaf': 4, 'min_samples_split': 10, 'n_estimators': 100}\n"]}],"source":["#Identifying optimal parameters for SVR and RFR (ecfp6)\n","from cuml.model_selection import GridSearchCV\n","\n","# Set up the hyperparameter grid for SVR\n","svr_params = {\n","    'C': [0.1, 1, 10],\n","    'gamma': ['scale', 'auto'],\n","    'kernel': ['linear', 'rbf']\n","}\n","\n","# Grid search for SVR\n","svr_search = GridSearchCV(SVR(), svr_params)\n","svr_search.fit(X_train_ecfp6, y_train_ecfp6)\n","\n","# Get the best parameters and best model\n","best_svr_params_ecfp6 = svr_search.best_params_\n","best_svr_model_ecfp6 = svr_search.best_estimator_\n","\n","print(\"Best SVR Parameters: \", best_svr_params_ecfp6)\n","\n","# Set up hyperparameter grid for RFR\n","rfr_params = {\n","    'n_estimators': [100, 200, 300],\n","    'max_depth': [10, 20, 30],\n","    'min_samples_split': [2, 5, 10],\n","    'min_samples_leaf': [1, 2, 4]\n","}\n","\n","# Set up the grid search with cross-validation\n","rfr_search = GridSearchCV(RandomForestRegressor(), rfr_params)\n","rfr_search.fit(X_train_ecfp6, y_train_ecfp6)\n","\n","# Get the best parameters and best model\n","best_rfr_params_ecfp6 = rfr_search.best_params_\n","best_rfr_model_ecfp6 = rfr_search.best_estimator_\n","\n","print(\"Best RFR Parameters: \", best_rfr_params_ecfp6)"]},{"cell_type":"code","execution_count":16,"metadata":{"id":"SsrUr-PLoGS5","executionInfo":{"status":"ok","timestamp":1700265351207,"user_tz":480,"elapsed":6,"user":{"displayName":"Sathya Raminani","userId":"13681115488434516434"}}},"outputs":[],"source":["#Function to train SVR and RFR model for ecfp4 and calculate metrics\n","def train_eval_ecfp4_SVR_RFR(receptor):\n","\n","  #Get train and test data for the given receptor\n","  ecfp4_train_receptor, ecfp4_test_receptor = get_data_by_receptor(ecfp4_train, ecfp4_test, receptor)\n","\n","  #Create X_train, X_test, y_train, y_test\n","  X_train = ecfp4_train_receptor['ecfp4']\n","  y_train = ecfp4_train_receptor['pAct']\n","  X_test = ecfp4_test_receptor['ecfp4']\n","  y_test = ecfp4_test_receptor['pAct']\n","\n","  #Convert X_train, X_test, y_train, y_test to representation that can be used\n","  X_train, y_train = convert_to_cupy(X_train, y_train)\n","  X_test, y_test = convert_to_cupy(X_test, y_test)\n","\n","  #Creating SVR model\n","  svr_model = SVR(C = 1,\n","                gamma = 'scale',\n","                kernel = 'rbf') #maybe just change to 'rbf'\n","  svr_model.fit(X_train, y_train)\n","\n","  #Evaluation SVR on training data\n","  svr_train_predictions = svr_model.predict(X_train)\n","  train_svr_r2 = r2_score(y_train, svr_train_predictions)\n","  train_svr_rmse = cp.sqrt(mean_squared_error(y_train, svr_train_predictions))\n","  print(f\"Train SVR R-squared: {train_svr_r2}\")\n","  print(f\"Train SVR RMSE: {train_svr_rmse}\" + \"\\n\")\n","\n","  #Evaluating SVR on test data\n","  svr_predictions = svr_model.predict(X_test)\n","  svr_r2 = r2_score(y_test, svr_predictions)\n","  svr_rmse = cp.sqrt(mean_squared_error(y_test, svr_predictions))\n","  print(f\"Test SVR R-squared: {svr_r2}\")\n","  print(f\"Test SVR RMSE: {svr_rmse}\" + \"\\n\")\n","\n","  #Creating RFR model\n","  rfr_model = RandomForestRegressor(max_depth = 30,\n","                                  min_samples_leaf = 4,\n","                                  min_samples_split = 10,\n","                                  n_estimators = 100)\n","  rfr_model.fit(X_train, y_train)\n","\n","  #Evaluating RFR on training data\n","  rfr_train_predictions = rfr_model.predict(X_train)\n","  train_rfr_r2 = r2_score(y_train, rfr_train_predictions)\n","  train_rfr_rmse = cp.sqrt(mean_squared_error(y_train, rfr_train_predictions))\n","  print(f\"Train RFR R-squared: {train_rfr_r2}\")\n","  print(f\"Train RFR RMSE: {train_rfr_rmse}\" + \"\\n\")\n","\n","  #Evaluating RFR on test data\n","  rfr_predictions = rfr_model.predict(X_test)\n","  rfr_r2 = r2_score(y_test, rfr_predictions)\n","  rfr_rmse = cp.sqrt(mean_squared_error(y_test, rfr_predictions))\n","  print(f\"RFR R-squared: {rfr_r2}\")\n","  print(f\"RFR RMSE: {rfr_rmse}\")\n","\n","  return svr_model, rfr_model"]},{"cell_type":"code","execution_count":17,"metadata":{"id":"M4RDdjluqx3R","executionInfo":{"status":"ok","timestamp":1700265354591,"user_tz":480,"elapsed":317,"user":{"displayName":"Sathya Raminani","userId":"13681115488434516434"}}},"outputs":[],"source":["#Function to train SVR and RFR model for ecfp6 and calculate metrics\n","def train_eval_ecfp6_SVR_RFR(receptor):\n","\n","  #Get train and test data for the given receptor\n","  ecfp6_train_receptor, ecfp6_test_receptor = get_data_by_receptor(ecfp6_train, ecfp6_test, receptor)\n","\n","  #Create X_train, X_test, y_train, y_test\n","  X_train = ecfp6_train_receptor['ecfp6']\n","  y_train = ecfp6_train_receptor['pAct']\n","  X_test = ecfp6_test_receptor['ecfp6']\n","  y_test = ecfp6_test_receptor['pAct']\n","\n","  #Convert X_train, X_test, y_train, y_test to representation that can be used\n","  X_train, y_train = convert_to_cupy(X_train, y_train)\n","  X_test, y_test = convert_to_cupy(X_test, y_test)\n","\n","  #Creating SVR model\n","  svr_model = SVR(C = 1,\n","                gamma = 'scale',\n","                kernel = 'rbf') #maybe just change to 'rbf'\n","  svr_model.fit(X_train, y_train)\n","\n","  #Evaluation SVR on training data\n","  svr_train_predictions = svr_model.predict(X_train)\n","  train_svr_r2 = r2_score(y_train, svr_train_predictions)\n","  train_svr_rmse = cp.sqrt(mean_squared_error(y_train, svr_train_predictions))\n","  print(f\"Train SVR R-squared: {train_svr_r2}\")\n","  print(f\"Train SVR RMSE: {train_svr_rmse}\" + \"\\n\")\n","\n","  #Evaluating SVR on test data\n","  svr_predictions = svr_model.predict(X_test)\n","  svr_r2 = r2_score(y_test, svr_predictions)\n","  svr_rmse = cp.sqrt(mean_squared_error(y_test, svr_predictions))\n","  print(f\"Test SVR R-squared: {svr_r2}\")\n","  print(f\"Test SVR RMSE: {svr_rmse}\" + \"\\n\")\n","\n","  #Creating RFR model\n","  rfr_model = RandomForestRegressor(max_depth = 30,\n","                                  min_samples_leaf = 4,\n","                                  min_samples_split = 10,\n","                                  n_estimators = 100)\n","  rfr_model.fit(X_train, y_train)\n","\n","  #Evaluating RFR on training data\n","  rfr_train_predictions = rfr_model.predict(X_train)\n","  train_rfr_r2 = r2_score(y_train, rfr_train_predictions)\n","  train_rfr_rmse = cp.sqrt(mean_squared_error(y_train, rfr_train_predictions))\n","  print(f\"Train RFR R-squared: {train_rfr_r2}\")\n","  print(f\"Train RFR RMSE: {train_rfr_rmse}\" + \"\\n\")\n","\n","  #Evaluating RFR on test data\n","  rfr_predictions = rfr_model.predict(X_test)\n","  rfr_r2 = r2_score(y_test, rfr_predictions)\n","  rfr_rmse = cp.sqrt(mean_squared_error(y_test, rfr_predictions))\n","  print(f\"RFR R-squared: {rfr_r2}\")\n","  print(f\"RFR RMSE: {rfr_rmse}\")\n","\n","  return svr_model, rfr_model"]},{"cell_type":"code","execution_count":18,"metadata":{"id":"c3Fl-ktdsIU7","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1700265549180,"user_tz":480,"elapsed":191019,"user":{"displayName":"Sathya Raminani","userId":"13681115488434516434"}},"outputId":"f34339ae-c255-4a45-fd1d-5b245097916f"},"outputs":[{"output_type":"stream","name":"stdout","text":["------------SVR and RFR Training and Evaluation for 5HT1A Receptor------------\n","\n","Train SVR R-squared: 0.7857996446923139\n","Train SVR RMSE: 0.5453782059791089\n","\n","Test SVR R-squared: 0.27154681716389806\n","Test SVR RMSE: 1.0856670281294516\n","\n","Train RFR R-squared: 0.833359111012971\n","Train RFR RMSE: 0.481036989011114\n","\n","RFR R-squared: 0.2214441060719019\n","RFR RMSE: 1.1223820803278521\n","\n","-----------------------------------------------------------------------------\n","\n","------------SVR and RFR Training and Evaluation for 5HT1B Receptor------------\n","\n","Train SVR R-squared: 0.8341750116502593\n","Train SVR RMSE: 0.4663077825879853\n","\n","Test SVR R-squared: -0.7890158079079828\n","Test SVR RMSE: 0.9891993966910395\n","\n","Train RFR R-squared: 0.8638347022362615\n","Train RFR RMSE: 0.42255271464491273\n","\n","RFR R-squared: -1.6023534589734236\n","RFR RMSE: 1.1930534349387043\n","\n","-----------------------------------------------------------------------------\n","\n","------------SVR and RFR Training and Evaluation for 5HT1D Receptor------------\n","\n","Train SVR R-squared: 0.8684872917029769\n","Train SVR RMSE: 0.46105141246308246\n","\n","Test SVR R-squared: -0.2262126572236518\n","Test SVR RMSE: 1.1620744021679843\n","\n","Train RFR R-squared: 0.8883547947193188\n","Train RFR RMSE: 0.42480100389757885\n","\n","RFR R-squared: -0.29441775370466194\n","RFR RMSE: 1.193955850293933\n","\n","-----------------------------------------------------------------------------\n","\n","------------SVR and RFR Training and Evaluation for 5HT2A Receptor------------\n","\n","Train SVR R-squared: 0.8246727747569246\n","Train SVR RMSE: 0.47684903636938725\n","\n","Test SVR R-squared: 0.1442672291413597\n","Test SVR RMSE: 1.0334633754534692\n","\n","Train RFR R-squared: 0.8574447709699655\n","Train RFR RMSE: 0.42997955470335125\n","\n","RFR R-squared: 0.19714007313182436\n","RFR RMSE: 1.0010272481912303\n","\n","-----------------------------------------------------------------------------\n","\n","------------SVR and RFR Training and Evaluation for 5HT2B Receptor------------\n","\n","Train SVR R-squared: 0.7279091263464579\n","Train SVR RMSE: 0.4817479912945452\n","\n","Test SVR R-squared: 0.163185357175624\n","Test SVR RMSE: 0.9306045327033277\n","\n","Train RFR R-squared: 0.7513612609381841\n","Train RFR RMSE: 0.46051875539344533\n","\n","RFR R-squared: 0.1631764337390501\n","RFR RMSE: 0.9306094944761982\n","\n","-----------------------------------------------------------------------------\n","\n","------------SVR and RFR Training and Evaluation for 5HT2C Receptor------------\n","\n","Train SVR R-squared: 0.790181822465404\n","Train SVR RMSE: 0.49334275547192175\n","\n","Test SVR R-squared: 0.2354500932109277\n","Test SVR RMSE: 0.9952704475769092\n","\n","Train RFR R-squared: 0.8171898119279961\n","Train RFR RMSE: 0.46049762814843276\n","\n","RFR R-squared: 0.2848085779574958\n","RFR RMSE: 0.9626077135345694\n","\n","-----------------------------------------------------------------------------\n","\n","------------SVR and RFR Training and Evaluation for 5HT4R Receptor------------\n","\n","Train SVR R-squared: 0.7831389385337111\n","Train SVR RMSE: 0.6128646977907222\n","\n","Test SVR R-squared: 0.44017499799079973\n","Test SVR RMSE: 0.781631384150069\n","\n","Train RFR R-squared: 0.829814482118132\n","Train RFR RMSE: 0.5429190950808578\n","\n","RFR R-squared: 0.4720913045668921\n","RFR RMSE: 0.7590235511703285\n","\n","-----------------------------------------------------------------------------\n","\n","------------SVR and RFR Training and Evaluation for 5HT5A Receptor------------\n","\n","Train SVR R-squared: 0.8853452304164517\n","Train SVR RMSE: 0.3779786885559711\n","\n","Test SVR R-squared: -0.18419563049176357\n","Test SVR RMSE: 2.8550602245749035\n","\n","Train RFR R-squared: 0.8620028955147087\n","Train RFR RMSE: 0.4146734575298142\n","\n","RFR R-squared: -0.22507956637024384\n","RFR RMSE: 2.903926999363088\n","\n","-----------------------------------------------------------------------------\n","\n","------------SVR and RFR Training and Evaluation for 5HT6R Receptor------------\n","\n","Train SVR R-squared: 0.7825071131937068\n","Train SVR RMSE: 0.5324868239980591\n","\n","Test SVR R-squared: 0.49076560658662727\n","Test SVR RMSE: 0.8338085242466724\n","\n","Train RFR R-squared: 0.8220361514023152\n","Train RFR RMSE: 0.48167292107931187\n","\n","RFR R-squared: 0.45366959146365604\n","RFR RMSE: 0.863644782443431\n","\n","-----------------------------------------------------------------------------\n","\n","------------SVR and RFR Training and Evaluation for 5HT7R Receptor------------\n","\n","Train SVR R-squared: 0.7950444698576808\n","Train SVR RMSE: 0.495578135971045\n","\n","Test SVR R-squared: 0.204789155668053\n","Test SVR RMSE: 0.9728545532538566\n","\n","Train RFR R-squared: 0.8344339235059197\n","Train RFR RMSE: 0.44541823833656313\n","\n","RFR R-squared: 0.21691684396526179\n","RFR RMSE: 0.9654075927588616\n","\n","-----------------------------------------------------------------------------\n","\n","------------SVR and RFR Training and Evaluation for 5HT1E Receptor------------\n","\n","Train SVR R-squared: 0.9106620750508845\n","Train SVR RMSE: 0.2205506231095651\n","\n","Test SVR R-squared: -0.9112383693024915\n","Test SVR RMSE: 0.6601037534386062\n","\n"]},{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.10/site-packages/cuml/internals/api_decorators.py:188: UserWarning: The number of bins, `n_bins` is greater than the number of samples used for training. Changing `n_bins` to number of training samples.\n","  ret = func(*args, **kwargs)\n"]},{"output_type":"stream","name":"stdout","text":["Train RFR R-squared: 0.8738214072989771\n","Train RFR RMSE: 0.26210976334253433\n","\n","RFR R-squared: -2.281197587797244\n","RFR RMSE: 0.864910095257422\n","\n","-----------------------------------------------------------------------------\n","\n","------------SVR and RFR Training and Evaluation for 5HT1F Receptor------------\n","\n","Train SVR R-squared: 0.6935094195047518\n","Train SVR RMSE: 0.4639373982106774\n","\n","Test SVR R-squared: -0.04996586964315597\n","Test SVR RMSE: 0.8881433329984987\n","\n","Train RFR R-squared: 0.6951248110839205\n","Train RFR RMSE: 0.46271316698328735\n","\n","RFR R-squared: 0.008111084058130658\n","RFR RMSE: 0.86323091938951\n","\n","-----------------------------------------------------------------------------\n","\n","------------SVR and RFR Training and Evaluation for ACM1 Receptor------------\n","\n","Train SVR R-squared: 0.7410764374787938\n","Train SVR RMSE: 0.6595771544796533\n","\n","Test SVR R-squared: 0.2212518567510865\n","Test SVR RMSE: 1.2275543057689005\n","\n","Train RFR R-squared: 0.7967333474562363\n","Train RFR RMSE: 0.5844036037873301\n","\n","RFR R-squared: 0.21548384582678026\n","RFR RMSE: 1.2320920270063267\n","\n","-----------------------------------------------------------------------------\n","\n","------------SVR and RFR Training and Evaluation for ACM2 Receptor------------\n","\n","Train SVR R-squared: 0.8096144011412745\n","Train SVR RMSE: 0.6178268366166884\n","\n","Test SVR R-squared: 0.4796350944905271\n","Test SVR RMSE: 1.171539135257161\n","\n","Train RFR R-squared: 0.8324785249160022\n","Train RFR RMSE: 0.5795420676589117\n","\n","RFR R-squared: 0.1647638118783702\n","RFR RMSE: 1.4842513497344385\n","\n","-----------------------------------------------------------------------------\n","\n","------------SVR and RFR Training and Evaluation for ACM3 Receptor------------\n","\n","Train SVR R-squared: 0.8433472083514232\n","Train SVR RMSE: 0.707018513245448\n","\n","Test SVR R-squared: 0.38230434117815515\n","Test SVR RMSE: 1.3568493319841355\n","\n","Train RFR R-squared: 0.9008093996897405\n","Train RFR RMSE: 0.5625964350867967\n","\n","RFR R-squared: 0.3164104576346839\n","RFR RMSE: 1.4273880472520122\n","\n","-----------------------------------------------------------------------------\n","\n","------------SVR and RFR Training and Evaluation for ACM4 Receptor------------\n","\n","Train SVR R-squared: 0.7379068249788981\n","Train SVR RMSE: 0.5764920912869171\n","\n","Test SVR R-squared: 0.18591502328763332\n","Test SVR RMSE: 1.1223377430389123\n","\n","Train RFR R-squared: 0.7686411940088019\n","Train RFR RMSE: 0.5416372381163357\n","\n","RFR R-squared: 0.029197699286654943\n","RFR RMSE: 1.2256150812945148\n","\n","-----------------------------------------------------------------------------\n","\n","------------SVR and RFR Training and Evaluation for ACM5 Receptor------------\n","\n","Train SVR R-squared: 0.8238848419352736\n","Train SVR RMSE: 0.47663842009047996\n","\n","Test SVR R-squared: -0.05724870952759065\n","Test SVR RMSE: 0.9516900855015917\n","\n","Train RFR R-squared: 0.8440962180621993\n","Train RFR RMSE: 0.44845513695277506\n","\n","RFR R-squared: 0.04573553493948601\n","RFR RMSE: 0.9041517745584334\n","\n","-----------------------------------------------------------------------------\n","\n","------------SVR and RFR Training and Evaluation for HRH1 Receptor------------\n","\n","Train SVR R-squared: 0.8140289921570414\n","Train SVR RMSE: 0.5711961844498129\n","\n","Test SVR R-squared: -0.0626096290997209\n","Test SVR RMSE: 1.349032485895166\n","\n","Train RFR R-squared: 0.8494613612262697\n","Train RFR RMSE: 0.5139095256781121\n","\n","RFR R-squared: 0.04398107154438302\n","RFR RMSE: 1.2795839381159098\n","\n","-----------------------------------------------------------------------------\n","\n","------------SVR and RFR Training and Evaluation for HRH2 Receptor------------\n","\n","Train SVR R-squared: 0.8580749673097923\n","Train SVR RMSE: 0.3801739427595669\n","\n","Test SVR R-squared: -0.041715103814071064\n","Test SVR RMSE: 0.9276873342720589\n","\n","Train RFR R-squared: 0.8717660708955248\n","Train RFR RMSE: 0.3613718508458548\n","\n","RFR R-squared: -0.039714770943131805\n","RFR RMSE: 0.9267962196318261\n","\n","-----------------------------------------------------------------------------\n","\n","------------SVR and RFR Training and Evaluation for HRH3 Receptor------------\n","\n","Train SVR R-squared: 0.8334094704349435\n","Train SVR RMSE: 0.47952975927998426\n","\n","Test SVR R-squared: 0.15992425857868386\n","Test SVR RMSE: 1.292931399065347\n","\n","Train RFR R-squared: 0.8631942730166504\n","Train RFR RMSE: 0.43455279650835393\n","\n","RFR R-squared: 0.16521674110934315\n","RFR RMSE: 1.2888522261791016\n","\n","-----------------------------------------------------------------------------\n","\n","------------SVR and RFR Training and Evaluation for HRH4 Receptor------------\n","\n","Train SVR R-squared: 0.6470067649060445\n","Train SVR RMSE: 0.7181345943009576\n","\n","Test SVR R-squared: 0.19532645814079008\n","Test SVR RMSE: 1.236720005206006\n","\n","Train RFR R-squared: 0.6901031811142296\n","Train RFR RMSE: 0.67287007818862\n","\n","RFR R-squared: 0.1366837301427568\n","RFR RMSE: 1.2809922077552074\n","\n","-----------------------------------------------------------------------------\n","\n","------------SVR and RFR Training and Evaluation for DRD1 Receptor------------\n","\n","Train SVR R-squared: 0.7647668973745122\n","Train SVR RMSE: 0.5771091336132315\n","\n","Test SVR R-squared: 0.1267354438610533\n","Test SVR RMSE: 1.0917478392695572\n","\n","Train RFR R-squared: 0.7923407995700833\n","Train RFR RMSE: 0.5422309687594543\n","\n","RFR R-squared: 0.10732478758351971\n","RFR RMSE: 1.1038146711308556\n","\n","-----------------------------------------------------------------------------\n","\n","------------SVR and RFR Training and Evaluation for DRD2 Receptor------------\n","\n","Train SVR R-squared: 0.7363299812749118\n","Train SVR RMSE: 0.5750071877266989\n","\n","Test SVR R-squared: 0.3796306953495674\n","Test SVR RMSE: 1.0269475576491678\n","\n","Train RFR R-squared: 0.786305475371055\n","Train RFR RMSE: 0.5176540257210451\n","\n","RFR R-squared: 0.2748516974993349\n","RFR RMSE: 1.1102902680425086\n","\n","-----------------------------------------------------------------------------\n","\n","------------SVR and RFR Training and Evaluation for DRD3 Receptor------------\n","\n","Train SVR R-squared: 0.7728807596043012\n","Train SVR RMSE: 0.564799536596787\n","\n","Test SVR R-squared: 0.20218739195916335\n","Test SVR RMSE: 1.080970270519497\n","\n","Train RFR R-squared: 0.817380444848042\n","Train RFR RMSE: 0.5064551695530428\n","\n","RFR R-squared: 0.13474798165372504\n","RFR RMSE: 1.1257309664438258\n","\n","-----------------------------------------------------------------------------\n","\n","------------SVR and RFR Training and Evaluation for DRD4 Receptor------------\n","\n","Train SVR R-squared: 0.7669834565587654\n","Train SVR RMSE: 0.4942458109287421\n","\n","Test SVR R-squared: 0.16154778565721684\n","Test SVR RMSE: 1.0918955590393167\n","\n","Train RFR R-squared: 0.8136292984073248\n","Train RFR RMSE: 0.44201645714027327\n","\n","RFR R-squared: 0.09653953866779519\n","RFR RMSE: 1.1334347332354826\n","\n","-----------------------------------------------------------------------------\n","\n","------------SVR and RFR Training and Evaluation for DRD5 Receptor------------\n","\n","Train SVR R-squared: 0.905042023668483\n","Train SVR RMSE: 0.4210258647196511\n","\n","Test SVR R-squared: 0.23147145708436867\n","Test SVR RMSE: 1.157008347197299\n","\n","Train RFR R-squared: 0.912471725384877\n","Train RFR RMSE: 0.4042194761843595\n","\n","RFR R-squared: 0.15744290633199987\n","RFR RMSE: 1.2114518598173643\n","\n","-----------------------------------------------------------------------------\n","\n","------------SVR and RFR Training and Evaluation for ADA1A Receptor------------\n","\n","Train SVR R-squared: 0.8003348650253919\n","Train SVR RMSE: 0.5498787127143243\n","\n","Test SVR R-squared: 0.1128354359185545\n","Test SVR RMSE: 1.2502051379719248\n","\n","Train RFR R-squared: 0.8431987647059237\n","Train RFR RMSE: 0.48729339988433956\n","\n","RFR R-squared: 0.1598819694241912\n","RFR RMSE: 1.2166042771231511\n","\n","-----------------------------------------------------------------------------\n","\n","------------SVR and RFR Training and Evaluation for ADA1B Receptor------------\n","\n","Train SVR R-squared: 0.7945644896031502\n","Train SVR RMSE: 0.487473258684749\n","\n","Test SVR R-squared: 0.12274492487148647\n","Test SVR RMSE: 1.2853948074842563\n","\n","Train RFR R-squared: 0.8323623520375198\n","Train RFR RMSE: 0.4403508290497264\n","\n","RFR R-squared: 0.016560662269396675\n","RFR RMSE: 1.3609663412217383\n","\n","-----------------------------------------------------------------------------\n","\n","------------SVR and RFR Training and Evaluation for ADA1D Receptor------------\n","\n","Train SVR R-squared: 0.8022591953629644\n","Train SVR RMSE: 0.5326074870085187\n","\n","Test SVR R-squared: 0.3142980693877271\n","Test SVR RMSE: 1.0391316324049322\n","\n","Train RFR R-squared: 0.8441385701300911\n","Train RFR RMSE: 0.4728555019705668\n","\n","RFR R-squared: 0.29521330997836304\n","RFR RMSE: 1.0534931746070126\n","\n","-----------------------------------------------------------------------------\n","\n","------------SVR and RFR Training and Evaluation for ADA2A Receptor------------\n","\n","Train SVR R-squared: 0.8510683217427071\n","Train SVR RMSE: 0.47108792583081965\n","\n","Test SVR R-squared: -0.1171909116457639\n","Test SVR RMSE: 1.5663949873263805\n","\n","Train RFR R-squared: 0.863439281610449\n","Train RFR RMSE: 0.45109844279174294\n","\n","RFR R-squared: -0.21200813455733836\n","RFR RMSE: 1.6315123100544393\n","\n","-----------------------------------------------------------------------------\n","\n","------------SVR and RFR Training and Evaluation for ADA2B Receptor------------\n","\n","[W] [23:58:49.528497] Warning: could not fill working set, found only 1008 elements\n","[W] [23:58:49.532726] Warning: could not fill working set, found only 1020 elements\n","[W] [23:58:49.535099] Warning: could not fill working set, found only 1014 elements\n","Train SVR R-squared: 0.8181683109845408\n","Train SVR RMSE: 0.44309110342365615\n","\n","Test SVR R-squared: -0.4590871411849231\n","Test SVR RMSE: 0.91287484512058\n","\n","Train RFR R-squared: 0.8248950070422718\n","Train RFR RMSE: 0.43481799449570385\n","\n","RFR R-squared: -0.22789581285633642\n","RFR RMSE: 0.8374355325377202\n","\n","-----------------------------------------------------------------------------\n","\n","------------SVR and RFR Training and Evaluation for ADA2C Receptor------------\n","\n","Train SVR R-squared: 0.831119178801542\n","Train SVR RMSE: 0.4772947843878861\n","\n","Test SVR R-squared: 0.25374531957051594\n","Test SVR RMSE: 1.97840774192848\n","\n","Train RFR R-squared: 0.8535626101955178\n","Train RFR RMSE: 0.4444495923272647\n","\n","RFR R-squared: 0.3902818438741541\n","RFR RMSE: 1.7882854072653331\n","\n","-----------------------------------------------------------------------------\n","\n","------------SVR and RFR Training and Evaluation for ADRB1 Receptor------------\n","\n","Train SVR R-squared: 0.7851916865066717\n","Train SVR RMSE: 0.5552756247634263\n","\n","Test SVR R-squared: 0.15639279508401693\n","Test SVR RMSE: 1.259198431628933\n","\n","Train RFR R-squared: 0.8350127283387392\n","Train RFR RMSE: 0.48664054199221324\n","\n","RFR R-squared: 0.1380455977128281\n","RFR RMSE: 1.2728176237294155\n","\n","-----------------------------------------------------------------------------\n","\n","------------SVR and RFR Training and Evaluation for ADRB2 Receptor------------\n","\n","Train SVR R-squared: 0.8066379296291277\n","Train SVR RMSE: 0.7216269060494511\n","\n","Test SVR R-squared: 0.27835450485976865\n","Test SVR RMSE: 1.5842374307370213\n","\n","Train RFR R-squared: 0.8536798634340319\n","Train RFR RMSE: 0.6277390166942394\n","\n","RFR R-squared: 0.35742835123864225\n","RFR RMSE: 1.4949239428390573\n","\n","-----------------------------------------------------------------------------\n","\n","------------SVR and RFR Training and Evaluation for ADRB3 Receptor------------\n","\n","Train SVR R-squared: 0.6067802389029322\n","Train SVR RMSE: 0.8357085189657983\n","\n","Test SVR R-squared: -35.36226176479248\n","Test SVR RMSE: 1.704076845121951\n","\n","Train RFR R-squared: 0.7092467468954933\n","Train RFR RMSE: 0.7186202533247223\n","\n","RFR R-squared: -33.6024985064276\n","RFR RMSE: 1.6623308325974384\n","\n","-----------------------------------------------------------------------------\n","\n"]}],"source":["#Training and evaluating ecfp4 SVR and RFR models\n","for receptor_family in [serotonin_models, muscarinic_models, histamine_models, dopamine_models, adrenoceptor_models]:\n","  for receptor in receptor_family.keys():\n","    print(f\"------------SVR and RFR Training and Evaluation for {receptor} Receptor------------\" + \"\\n\")\n","    svr_model, rfr_model = train_eval_ecfp4_SVR_RFR(receptor)\n","    receptor_family[receptor] = [svr_model, rfr_model]\n","    print(\"\\n\" + \"-----------------------------------------------------------------------------\" + \"\\n\")"]},{"cell_type":"code","execution_count":19,"metadata":{"id":"7yR3pom4s7GB","executionInfo":{"status":"ok","timestamp":1700265872296,"user_tz":480,"elapsed":323148,"user":{"displayName":"Sathya Raminani","userId":"13681115488434516434"}},"colab":{"base_uri":"https://localhost:8080/"},"outputId":"57a673e1-8673-489e-8452-77461334d248"},"outputs":[{"output_type":"stream","name":"stdout","text":["------------SVR and RFR Training and Evaluation for 5HT1A Receptor------------\n","\n","Train SVR R-squared: 0.8155600289146671\n","Train SVR RMSE: 0.506075378118919\n","\n","Test SVR R-squared: 0.2777000590282751\n","Test SVR RMSE: 1.0810719909090452\n","\n","Train RFR R-squared: 0.8389556584476241\n","Train RFR RMSE: 0.47289031609557713\n","\n","RFR R-squared: 0.2411672125712626\n","RFR RMSE: 1.1080742677250166\n","\n","-----------------------------------------------------------------------------\n","\n","------------SVR and RFR Training and Evaluation for 5HT1B Receptor------------\n","\n","Train SVR R-squared: 0.8546664716071921\n","Train SVR RMSE: 0.43654657455603635\n","\n","Test SVR R-squared: -0.6287989598621002\n","Test SVR RMSE: 0.9438663330870164\n","\n","Train RFR R-squared: 0.8711628806094333\n","Train RFR RMSE: 0.41102494425537667\n","\n","RFR R-squared: -1.4410298123881344\n","RFR RMSE: 1.1554822955293018\n","\n","-----------------------------------------------------------------------------\n","\n","------------SVR and RFR Training and Evaluation for 5HT1D Receptor------------\n","\n","Train SVR R-squared: 0.8890630378219042\n","Train SVR RMSE: 0.42345145626381103\n","\n","Test SVR R-squared: -0.1338022223501243\n","Test SVR RMSE: 1.1174283598993529\n","\n","Train RFR R-squared: 0.8977222052923617\n","Train RFR RMSE: 0.40658951384094133\n","\n","RFR R-squared: -0.17134494416146806\n","RFR RMSE: 1.1357779711304226\n","\n","-----------------------------------------------------------------------------\n","\n","------------SVR and RFR Training and Evaluation for 5HT2A Receptor------------\n","\n","Train SVR R-squared: 0.8472401089053985\n","Train SVR RMSE: 0.4451033875229814\n","\n","Test SVR R-squared: 0.17825463553623355\n","Test SVR RMSE: 1.0127322495257203\n","\n","Train RFR R-squared: 0.8512094183534429\n","Train RFR RMSE: 0.4392825484941021\n","\n","RFR R-squared: 0.2727296514627612\n","RFR RMSE: 0.952739012932821\n","\n","-----------------------------------------------------------------------------\n","\n","------------SVR and RFR Training and Evaluation for 5HT2B Receptor------------\n","\n","Train SVR R-squared: 0.755635996962661\n","Train SVR RMSE: 0.4565428445020654\n","\n","Test SVR R-squared: 0.16010667694772862\n","Test SVR RMSE: 0.9323148298923992\n","\n","Train RFR R-squared: 0.746320777221285\n","Train RFR RMSE: 0.46516322639465985\n","\n","RFR R-squared: 0.14880872884289398\n","RFR RMSE: 0.9385644678922292\n","\n","-----------------------------------------------------------------------------\n","\n","------------SVR and RFR Training and Evaluation for 5HT2C Receptor------------\n","\n","Train SVR R-squared: 0.8164600807712458\n","Train SVR RMSE: 0.46141580670378274\n","\n","Test SVR R-squared: 0.27163493426144625\n","Test SVR RMSE: 0.9714327545780602\n","\n","Train RFR R-squared: 0.8175008945377471\n","Train RFR RMSE: 0.4601056538290139\n","\n","RFR R-squared: 0.3026800508248634\n","RFR RMSE: 0.9505046238447299\n","\n","-----------------------------------------------------------------------------\n","\n","------------SVR and RFR Training and Evaluation for 5HT4R Receptor------------\n","\n","Train SVR R-squared: 0.8050958679457437\n","Train SVR RMSE: 0.5810109795848888\n","\n","Test SVR R-squared: 0.377299412462044\n","Test SVR RMSE: 0.8243572873719226\n","\n","Train RFR R-squared: 0.8408209381859315\n","Train RFR RMSE: 0.5250694935847352\n","\n","RFR R-squared: 0.40918138614705557\n","RFR RMSE: 0.802976672089498\n","\n","-----------------------------------------------------------------------------\n","\n","------------SVR and RFR Training and Evaluation for 5HT5A Receptor------------\n","\n","Train SVR R-squared: 0.9013216742269732\n","Train SVR RMSE: 0.3506566965557051\n","\n","Test SVR R-squared: -0.184128597073695\n","Test SVR RMSE: 2.8549794156489106\n","\n","Train RFR R-squared: 0.8855385899477316\n","Train RFR RMSE: 0.3776598329941506\n","\n","RFR R-squared: -0.14160164928198515\n","RFR RMSE: 2.8032436065211\n","\n","-----------------------------------------------------------------------------\n","\n","------------SVR and RFR Training and Evaluation for 5HT6R Receptor------------\n","\n","Train SVR R-squared: 0.8063686562633198\n","Train SVR RMSE: 0.5024283845090414\n","\n","Test SVR R-squared: 0.4746806294820257\n","Test SVR RMSE: 0.8468747304434278\n","\n","Train RFR R-squared: 0.8239036784978475\n","Train RFR RMSE: 0.47913895250612326\n","\n","RFR R-squared: 0.43064636785633925\n","RFR RMSE: 0.8816546745633214\n","\n","-----------------------------------------------------------------------------\n","\n","------------SVR and RFR Training and Evaluation for 5HT7R Receptor------------\n","\n","Train SVR R-squared: 0.8201917282459351\n","Train SVR RMSE: 0.464180776514715\n","\n","Test SVR R-squared: 0.20435532237758547\n","Test SVR RMSE: 0.9731198911492301\n","\n","Train RFR R-squared: 0.8341189180083566\n","Train RFR RMSE: 0.44584176265451203\n","\n","RFR R-squared: 0.19434138493077546\n","RFR RMSE: 0.9792245580249674\n","\n","-----------------------------------------------------------------------------\n","\n","------------SVR and RFR Training and Evaluation for 5HT1E Receptor------------\n","\n","Train SVR R-squared: 0.9111291058753047\n","Train SVR RMSE: 0.21997338275759443\n","\n","Test SVR R-squared: -1.0166395138124034\n","Test SVR RMSE: 0.6780612261689277\n","\n","Train RFR R-squared: 0.8851737877556024\n","Train RFR RMSE: 0.25004079909712135\n","\n","RFR R-squared: -1.4873934532264115\n","RFR RMSE: 0.7530555574464368\n","\n","-----------------------------------------------------------------------------\n","\n","------------SVR and RFR Training and Evaluation for 5HT1F Receptor------------\n","\n","Train SVR R-squared: 0.7524094150764327\n","Train SVR RMSE: 0.41698254884529184\n","\n","Test SVR R-squared: -0.05408300200446248\n","Test SVR RMSE: 0.8898829257796431\n","\n","Train RFR R-squared: 0.709592839314057\n","Train RFR RMSE: 0.45160056554561623\n","\n","RFR R-squared: -0.0061085613386162585\n","RFR RMSE: 0.8693965076551675\n","\n","-----------------------------------------------------------------------------\n","\n","------------SVR and RFR Training and Evaluation for ACM1 Receptor------------\n","\n","Train SVR R-squared: 0.7610995834160518\n","Train SVR RMSE: 0.6335607603672224\n","\n","Test SVR R-squared: 0.20888409663009933\n","Test SVR RMSE: 1.2372636657954832\n","\n","Train RFR R-squared: 0.8003669163700263\n","Train RFR RMSE: 0.5791566873775403\n","\n","RFR R-squared: 0.21931772212577239\n","RFR RMSE: 1.2290777655250016\n","\n","-----------------------------------------------------------------------------\n","\n","------------SVR and RFR Training and Evaluation for ACM2 Receptor------------\n","\n","Train SVR R-squared: 0.8288257029908054\n","Train SVR RMSE: 0.5858264796947485\n","\n","Test SVR R-squared: 0.4672327826628456\n","Test SVR RMSE: 1.1854180832773709\n","\n","Train RFR R-squared: 0.8425408528881532\n","Train RFR RMSE: 0.5618671856628716\n","\n","RFR R-squared: 0.4853672544706714\n","RFR RMSE: 1.165068631567668\n","\n","-----------------------------------------------------------------------------\n","\n","------------SVR and RFR Training and Evaluation for ACM3 Receptor------------\n","\n","Train SVR R-squared: 0.8517056644733595\n","Train SVR RMSE: 0.6878979223797764\n","\n","Test SVR R-squared: 0.35640436966200995\n","Test SVR RMSE: 1.385003573741401\n","\n","Train RFR R-squared: 0.9078275137439933\n","Train RFR RMSE: 0.5423284250843678\n","\n","RFR R-squared: 0.35807492663912543\n","RFR RMSE: 1.3832049049501225\n","\n","-----------------------------------------------------------------------------\n","\n","------------SVR and RFR Training and Evaluation for ACM4 Receptor------------\n","\n","Train SVR R-squared: 0.7585951568522264\n","Train SVR RMSE: 0.5532717390568678\n","\n","Test SVR R-squared: 0.1670995906415237\n","Test SVR RMSE: 1.1352335974560823\n","\n","Train RFR R-squared: 0.7754660183034893\n","Train RFR RMSE: 0.5335885929551847\n","\n","RFR R-squared: 0.09032000405354157\n","RFR RMSE: 1.1864051417129104\n","\n","-----------------------------------------------------------------------------\n","\n","------------SVR and RFR Training and Evaluation for ACM5 Receptor------------\n","\n","Train SVR R-squared: 0.8363886351817483\n","Train SVR RMSE: 0.4594067919688281\n","\n","Test SVR R-squared: -0.049305062682835965\n","Test SVR RMSE: 0.9481080788274032\n","\n","Train RFR R-squared: 0.8494343224943026\n","Train RFR RMSE: 0.4407107754639048\n","\n","RFR R-squared: -0.01557324198792931\n","RFR RMSE: 0.9327442660432086\n","\n","-----------------------------------------------------------------------------\n","\n","------------SVR and RFR Training and Evaluation for HRH1 Receptor------------\n","\n","Train SVR R-squared: 0.8267700852595901\n","Train SVR RMSE: 0.5512823918717985\n","\n","Test SVR R-squared: 0.021788880450505643\n","Test SVR RMSE: 1.2943503100697606\n","\n","Train RFR R-squared: 0.8556725966367112\n","Train RFR RMSE: 0.5031958775407678\n","\n","RFR R-squared: 0.056226662599763055\n","RFR RMSE: 1.2713624679251623\n","\n","-----------------------------------------------------------------------------\n","\n","------------SVR and RFR Training and Evaluation for HRH2 Receptor------------\n","\n","Train SVR R-squared: 0.873837200073751\n","Train SVR RMSE: 0.3584416804823888\n","\n","Test SVR R-squared: -0.11726681422164664\n","Test SVR RMSE: 0.9607393885052372\n","\n","Train RFR R-squared: 0.8784396337876005\n","Train RFR RMSE: 0.35184294347575495\n","\n","RFR R-squared: -0.2781721962493171\n","RFR RMSE: 1.0275946388363735\n","\n","-----------------------------------------------------------------------------\n","\n","------------SVR and RFR Training and Evaluation for HRH3 Receptor------------\n","\n","Train SVR R-squared: 0.8559526821532173\n","Train SVR RMSE: 0.44590567340366305\n","\n","Test SVR R-squared: 0.1912847470672876\n","Test SVR RMSE: 1.268568951335338\n","\n","Train RFR R-squared: 0.8674702462814945\n","Train RFR RMSE: 0.42770773597436373\n","\n","RFR R-squared: 0.23647714515673257\n","RFR RMSE: 1.2326145255314493\n","\n","-----------------------------------------------------------------------------\n","\n","------------SVR and RFR Training and Evaluation for HRH4 Receptor------------\n","\n","Train SVR R-squared: 0.6673813777291584\n","Train SVR RMSE: 0.6971013715230598\n","\n","Test SVR R-squared: 0.19572610051765815\n","Test SVR RMSE: 1.236412857599611\n","\n","Train RFR R-squared: 0.6958205663491169\n","Train RFR RMSE: 0.6666341849728381\n","\n","RFR R-squared: 0.12643121293391002\n","RFR RMSE: 1.2885761215256466\n","\n","-----------------------------------------------------------------------------\n","\n","------------SVR and RFR Training and Evaluation for DRD1 Receptor------------\n","\n","Train SVR R-squared: 0.7816890545135791\n","Train SVR RMSE: 0.555963761530216\n","\n","Test SVR R-squared: 0.1538329013699169\n","Test SVR RMSE: 1.0746758552473206\n","\n","Train RFR R-squared: 0.800535426113614\n","Train RFR RMSE: 0.5314245532395145\n","\n","RFR R-squared: 0.144575557907755\n","RFR RMSE: 1.0805385158282586\n","\n","-----------------------------------------------------------------------------\n","\n","------------SVR and RFR Training and Evaluation for DRD2 Receptor------------\n","\n","Train SVR R-squared: 0.7587479776398537\n","Train SVR RMSE: 0.550019870906369\n","\n","Test SVR R-squared: 0.34952418153132847\n","Test SVR RMSE: 1.0515712256747727\n","\n","Train RFR R-squared: 0.7853825779310408\n","Train RFR RMSE: 0.5187706356876833\n","\n","RFR R-squared: 0.25741339755334003\n","RFR RMSE: 1.1235610377784242\n","\n","-----------------------------------------------------------------------------\n","\n","------------SVR and RFR Training and Evaluation for DRD3 Receptor------------\n","\n","Train SVR R-squared: 0.8018123232237153\n","Train SVR RMSE: 0.5276010990803668\n","\n","Test SVR R-squared: 0.2457037217446285\n","Test SVR RMSE: 1.051076399470897\n","\n","Train RFR R-squared: 0.8229442291604872\n","Train RFR RMSE: 0.49868052890958076\n","\n","RFR R-squared: 0.16141657924154496\n","RFR RMSE: 1.1082466781082045\n","\n","-----------------------------------------------------------------------------\n","\n","------------SVR and RFR Training and Evaluation for DRD4 Receptor------------\n","\n","Train SVR R-squared: 0.809271455409631\n","Train SVR RMSE: 0.44715435680686916\n","\n","Test SVR R-squared: 0.1189911721795266\n","Test SVR RMSE: 1.119262805041518\n","\n","Train RFR R-squared: 0.8198990508717053\n","Train RFR RMSE: 0.43451784802563265\n","\n","RFR R-squared: 0.052545752720898675\n","RFR RMSE: 1.1607028882170225\n","\n","-----------------------------------------------------------------------------\n","\n","------------SVR and RFR Training and Evaluation for DRD5 Receptor------------\n","\n","Train SVR R-squared: 0.9234994679889864\n","Train SVR RMSE: 0.37789859639316203\n","\n","Test SVR R-squared: 0.23491376041415668\n","Test SVR RMSE: 1.1544142708076963\n","\n","Train RFR R-squared: 0.9269554758734879\n","Train RFR RMSE: 0.3692639263382997\n","\n","RFR R-squared: 0.09864194403354232\n","RFR RMSE: 1.2530118078836285\n","\n","-----------------------------------------------------------------------------\n","\n","------------SVR and RFR Training and Evaluation for ADA1A Receptor------------\n","\n","Train SVR R-squared: 0.822443896545769\n","Train SVR RMSE: 0.5185415865087943\n","\n","Test SVR R-squared: 0.09418116618482697\n","Test SVR RMSE: 1.2632806945082369\n","\n","Train RFR R-squared: 0.8492827370615688\n","Train RFR RMSE: 0.4777462519420286\n","\n","RFR R-squared: 0.13419529392545315\n","RFR RMSE: 1.2350631304090747\n","\n","-----------------------------------------------------------------------------\n","\n","------------SVR and RFR Training and Evaluation for ADA1B Receptor------------\n","\n","Train SVR R-squared: 0.8198181517963404\n","Train SVR RMSE: 0.45652919682094517\n","\n","Test SVR R-squared: 0.10700220769538993\n","Test SVR RMSE: 1.2968770028508159\n","\n","Train RFR R-squared: 0.8397855525874118\n","Train RFR RMSE: 0.4304908023954505\n","\n","RFR R-squared: -0.02320671703150956\n","RFR RMSE: 1.3882103810548205\n","\n","-----------------------------------------------------------------------------\n","\n","------------SVR and RFR Training and Evaluation for ADA1D Receptor------------\n","\n","Train SVR R-squared: 0.8237956575530052\n","Train SVR RMSE: 0.5027677616557988\n","\n","Test SVR R-squared: 0.343172880342835\n","Test SVR RMSE: 1.0170174798278393\n","\n","Train RFR R-squared: 0.8508168081479084\n","Train RFR RMSE: 0.46261431365679256\n","\n","RFR R-squared: 0.2863137513466749\n","RFR RMSE: 1.0601237002601456\n","\n","-----------------------------------------------------------------------------\n","\n","------------SVR and RFR Training and Evaluation for ADA2A Receptor------------\n","\n","Train SVR R-squared: 0.8648225715104804\n","Train SVR RMSE: 0.44880792989324353\n","\n","Test SVR R-squared: -0.10313132753266863\n","Test SVR RMSE: 1.5565074249470767\n","\n","Train RFR R-squared: 0.8717539114792262\n","Train RFR RMSE: 0.43715001292855293\n","\n","RFR R-squared: -0.14480428401244128\n","RFR RMSE: 1.5856349528993299\n","\n","-----------------------------------------------------------------------------\n","\n","------------SVR and RFR Training and Evaluation for ADA2B Receptor------------\n","\n","[W] [00:03:52.939124] Warning: could not fill working set, found only 1000 elements\n","[W] [00:03:52.944262] Warning: could not fill working set, found only 1021 elements\n","[W] [00:03:52.946690] Warning: could not fill working set, found only 1010 elements\n","[W] [00:03:52.948001] Warning: could not fill working set, found only 1020 elements\n","Train SVR R-squared: 0.8338262996983834\n","Train SVR RMSE: 0.42358384580359565\n","\n","Test SVR R-squared: -0.5359647179668576\n","Test SVR RMSE: 0.9366152934159878\n","\n","Train RFR R-squared: 0.8329476399413235\n","Train RFR RMSE: 0.42470223993639455\n","\n","RFR R-squared: -0.5287773368886113\n","RFR RMSE: 0.9344213287259023\n","\n","-----------------------------------------------------------------------------\n","\n","------------SVR and RFR Training and Evaluation for ADA2C Receptor------------\n","\n","Train SVR R-squared: 0.842020778959605\n","Train SVR RMSE: 0.4616326382816418\n","\n","Test SVR R-squared: 0.22939328959886707\n","Test SVR RMSE: 2.010428638302125\n","\n","Train RFR R-squared: 0.8572926989344339\n","Train RFR RMSE: 0.43875251502403884\n","\n","RFR R-squared: 0.3282926758274287\n","RFR RMSE: 1.876991520867181\n","\n","-----------------------------------------------------------------------------\n","\n","------------SVR and RFR Training and Evaluation for ADRB1 Receptor------------\n","\n","Train SVR R-squared: 0.8075625170261966\n","Train SVR RMSE: 0.5255667728549029\n","\n","Test SVR R-squared: 0.16875264125793044\n","Test SVR RMSE: 1.2499400195254935\n","\n","Train RFR R-squared: 0.8434699982425986\n","Train RFR RMSE: 0.47400384196807915\n","\n","RFR R-squared: 0.20494514366359995\n","RFR RMSE: 1.2224260081503648\n","\n","-----------------------------------------------------------------------------\n","\n","------------SVR and RFR Training and Evaluation for ADRB2 Receptor------------\n","\n","Train SVR R-squared: 0.821739480204935\n","Train SVR RMSE: 0.6928746275432779\n","\n","Test SVR R-squared: 0.3045558924648063\n","Test SVR RMSE: 1.5552114089435154\n","\n","Train RFR R-squared: 0.8576545811534069\n","Train RFR RMSE: 0.6191541970157916\n","\n","RFR R-squared: 0.2928336233665657\n","RFR RMSE: 1.568263805446613\n","\n","-----------------------------------------------------------------------------\n","\n","------------SVR and RFR Training and Evaluation for ADRB3 Receptor------------\n","\n","Train SVR R-squared: 0.6228254061875631\n","Train SVR RMSE: 0.8184805762378202\n","\n","Test SVR R-squared: -38.851140777779584\n","Test SVR RMSE: 1.7839558820155423\n","\n","Train RFR R-squared: 0.7177528845068103\n","Train RFR RMSE: 0.7080304210441297\n","\n","RFR R-squared: -13.09933887688495\n","RFR RMSE: 1.061116591905593\n","\n","-----------------------------------------------------------------------------\n","\n"]}],"source":["#Training and evaluating ecfp6 SVR and RFR models\n","for receptor_family in [serotonin_models, muscarinic_models, histamine_models, dopamine_models, adrenoceptor_models]:\n","  for receptor in receptor_family.keys():\n","    print(f\"------------SVR and RFR Training and Evaluation for {receptor} Receptor------------\" + \"\\n\")\n","    svr_model, rfr_model = train_eval_ecfp6_SVR_RFR(receptor)\n","    receptor_family[receptor].append([svr_model, rfr_model])\n","    print(\"\\n\" + \"-----------------------------------------------------------------------------\" + \"\\n\")"]}],"metadata":{"accelerator":"GPU","colab":{"provenance":[],"mount_file_id":"1Rk-NuFgJWlb0EYBTqAUnpKHAY4ZC7-7y","authorship_tag":"ABX9TyO9GKPi3e1wJGul5PE7blLU"},"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"}},"nbformat":4,"nbformat_minor":0}
